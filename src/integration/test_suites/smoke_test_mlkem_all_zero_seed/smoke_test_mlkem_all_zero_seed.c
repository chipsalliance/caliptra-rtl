// SPDX-License-Identifier: Apache-2.0
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//

#include "caliptra_defines.h"
#include "caliptra_isr.h"
#include "riscv_hw_if.h"
#include "riscv-csr.h"
#include "printf.h"
#include "mlkem.h"

volatile uint32_t* stdout           = (uint32_t *)STDOUT;
volatile uint32_t  intr_count = 0;
#ifdef CPT_VERBOSITY
    enum printf_verbosity verbosity_g = CPT_VERBOSITY;
#else
    enum printf_verbosity verbosity_g = LOW;
#endif

volatile caliptra_intr_received_s cptra_intr_rcv = {0};

/*
    "z":  "0000000000000000000000000000000000000000000000000000000000000000",
    "d":  "0000000000000000000000000000000000000000000000000000000000000000",
    "ek": "b1572c900b8b8202357437819c129e3cd66d21d7af55c5682b951deff475df1b3aae0699b1ca0b9ac8a054f2b3eadc7547b307d147cc56d92bbe274c7ce42f77919c38e858a3c724b4113da1829e20e607bee0a9b5216cb1cb7facc71d3b12ae0cd48bbf0444687c60fca7ab0db70b8dd80445b5b055350d002b30d66462202c91c55779800020b51547fc93b29379a4b74c2d4de3a69290a0e0a84f5f99418890017f0325759611c8f77f28bb7b12a556aa7a6792cba00ae2c272a1c322e36cc1fab9f5254d6a7b24c6c03cc4e20652508c41e0abd5842c1f26ba1d91b15d90764cbb5721009cf6b19840f4317c204c9de06f79d15e345791d866a0dc61c1ecf0951bb0cdcc86cc4204121425280ae80e86405c2db72ffd468ba1811546f9bb8cbaa08eb9bc43b4ca4351987874b1ce76130ac20b8a505fce250e0fab01e33b0b32294e78d9ba00474b1e7c948d9abe3874b9b8d19cff71145c41a53bc84c42b184a21376bf3670b02593c95a8c854a7047ac2dd020c53c9c6a4b88c313aaa190a9895e25cb3d02b62b7b5c7a5b710638009e3238dac827e852105c74afd80528c7514dc67573f6c50a19234626da0e040b4f7bc97954f93d42d78c02ac50c9b7a98964961bb80584eb05afc266ecc3250322621c736eadf3903cfa8cb9b2a68c17369bd9c8905602ad38be7c30bdb11b69e845c202c1063eeb5597f7bf2b05490dc0622fb24e499ba4240bca6aba7f232464ee956100ec8988664c967859eb89349d360017eacf8b3c2727195209b176dd21412cc09fc5c6c58fe343e2037027e1884ae50bc5b6385619bcdbcc185c53c065385efcbc133fd87439a247d56590a3c6bc345c39a6822e2005165119784becbf096396f4248670a5acbcb0b95645ac7c57a193583f73899f8112848689c478ab1cbad34a77677295f00b508baefb3a44a414625e099b12f619a038b63b89296ec82f58f7be74316892c345c460a7576ab11892a87231c3f47a8edc171349407ad7d6c409cc702e471e2f00a39ac7aee45b8c0d30a6679aaf902a22e8f885dcc4af21f183f181b0c99bae8fa942f4d23886486d02d179c236234f499b82507a2580c2ccd5c2c134b4f48678a8f4695ca903dde71a57934fad37657310af29caa9f24654e08b809a80aa227897d7605b79ba75d4bb1a2702d0fccaa0cdbb4101438aef8c196ac211aa408e01f77972c92ee78a00897bc3f8604250b7a1a2b904432b79d39a5d333629a4c9bee7070b8edc3096003f787320e3157155c30fb8cc7982c634fcd09e28db8576e61098928dbd30071f054245ec6e1595b29a422e7a6a2e93e4c512aa752bacb7f3690e146276f570b43ab21e34286270094147daac33e6361c9196275cb23eb3c57280c50daa640841691769a2ef836121a554153c837d073014ba61408380f11bbb2724ca8de52e70c255e334cfe3c80f7f2b6a4b2833615b9b987a1c2f976acf999e49a416dce24e7d46645c445401509459b4c484984f9fc21d5f472cefb31b7eba72df635e39f89dcdfb2d7d92a1173524d1e4afa0424d30b7aabfe38dde1a2603aa630c61666888a46acc5580c5076875a4b52c5e3944a9235ba31d27c3738859c207a10398be325422a2523b0dc412d3ea6101c3adca665bf250acecf3c2d0a05099336ade592747fcaa5092af3b294099e47b57c50bf4eaaf39a14e49aa7a827924e71a244306473dc2783b270eeb41a228311591b17480412dac9a21c0b96ad54bb9cc1661427cc9797b7ecf913e1e57003afba004082f9d77b270a301cd1910ef1762c2d294f6a2cfa5c3ad1a088a96215682fc7a09785ece2194cfab7c3d35618f5a891d03bd6f7a65c35029c49048aea19f88179856752a653a12151a6a8f02c6f93b9dfdb27604454f6e1413945a93ad033543f2bb47f6b2657355e09cabd6b1023bb7c2ad616f0e30c443167dbce22b6c38c379c78281e534dec17371522f2cac0cd5d99448ebc912678ff1a7b787b64f0fb9c3d6c76910ab8bf99014eea6c91fa3ce25920b6bfc63fa55200c781c77704c24a574c1ca0f90068d6f1396acb50c219b08e03a1faf392d82a1bb7f26aec454b06b49ce9c27b37e9b72edf80af182469759afe7d354bc018190f43431d700a6bc62f1844546b001d320753de901cfb159b249253dbf948f8117063d5dbc40c97e9290c47ea62dedcaa0ec",
    "dk": "8bb57f775b75158c5a12f8345d3a94d3859f4086a95c0c5372621436d084fc6a197a4463165bc2ebd7a31270c3ab315df7915f215c6f82c818f48b19f133c3eef3bf01a4760eb2367ee77528498b56a21752620fd463cf1c1481983c87849c9c9f3caf56f706a34b42d2c307065285d9cc1ef4aba7cc116a2d501aff80b1ab09492d98152c702743c74fe68253ff8802f334cbea61491697aa0a07491ba9bfe26b8934b3b7900a09bd08b3ec4603f4e1668f522ea3037f81c23a1634645254b68201864b9239fcf6c912d0928be8aa1941bb4d77a11e90a2af159d19070c04f3cce6b52cbf2c498a258278d5bce87632f71179d148c071777c2f1c032fca1ddda896d8cb4824d2c0eda3515ef90c88f875e723159b57585a381083477b39e290f1e33f4ec6a45e45c2fc2b388d92bf13a3a5a4cc97880619fe521a43f65f426c95f1a6bc1d8a45e2093d82ecb4c7d5bff11c6ca959c7f35b93ab3c8010114c2d82848dea38aae23bac5617515b2a908ab0558a55e83736ebb388a189b60001741a273513720650d09e3b960d0043b535f8a65ef583772155b387c266d209bb963d1df1c9e713ae1cc42c530c8b348088fd37a29800cf1e9622c40665d08b911ecc84f20a67b03646d2e3c1a1f0198c520c885b5cc1f0bc37c21604a80bbde38fb02c85a1d818f9d54ef3967963e8825d8943a1175c1e519bcfda62ba25a1cf271797b33739b0c1d0ccbcffaa20b2449b6ca4669454cad6983d913b9a8d685d2724199178ac734c452c57ac4401512a258a72b91462f6414a37c901c8ad7f26789026c1ff507445a72db73879d7ea8239b2782b69373c75c17dc89c61663ffb25400583a59b4a180fa46d0c893600ba50ef2a84301cac86b69de9201a584890832c4dba52588ec3bda62486ef7768b1c39c6897c5831565c13c70b7950382e23495731174da84c7a1b0e8f47e0693062610c7e553b19b2cb73444acbf7c7ea4499c8c6871067255b406bad52919044a95f5c6c8ecc0398067b942517fc8f03bfe1861e2c70f6e4b291a52ba4301beee369a7203a6df4c3b96d779cda7ae3b5bad2c0a47a430b3c630ca075a3b0572a4401a26e50183a3d21c4063738c697bd5eaca29012827981480308671f4739ef16a3645a82f6972f7863d08a2b6e2a33961617e0d502e2f4b90415b15360b7f2942027711b0c7486733db255e11215a2948eb62b8c5543b767b3592e08706e114e4e5297d8011a7d4b77609cf71430489618b5be7b707b3356de9bde9c5c179f62a7fc6c77460c4c1bcbf9d935a96d804e21b1801a8274c4a87601718607245b88b886e5603d1e002de81c67f448bd3a34ae9d450c53a3003159bada7c5465019c6721df518861381278efa827e4bab7088aad4db46727961e4863bf21cadbcf667a4d22635e7cb3444aa935065c0ab289b589844258162da94d3fca8244c2fce254efe39014163cc9184449bc132b2d77b76d2c863bb68659bcfbcf8319f6cc646d681b5465914dc5febe6b422389737425cbd550f013b762d3a86476379bb2019395b5608710d149c6c68fb9b5c869e7c45909a0177306ac82cec7c568430c9c936b703cd66f2154c526468d0042759c5895cc897257f49e609d2c29babe394d8f955479622182494ae33460ba15d3908b7c264151738cb5a60371c73c81b0b2472d0aeeac774032c1a215c6e34ec69a9840b5bb304cbe13db6e56445071fbe0567a41a2fd2405fc9c12a8f97540457c0f501a6a64cc9a6b77d58a0405505c513b4b70f953605ecae33682beb14a54b86c20ee791ba5c927a22363b9c77c2a3976e9b057877ccc2200f384356a6b2c3a8262f3640c61461b58ab50de28329adb854a736c3f37b50c534a5c37042488c0ea804b1ff93b169d95159b369d1a03a44c1c2b7bc9372883a13e761795072fbb6bc93043c3b801e57b7b848a4149c4798aff72524028e7ef777a1c62e66013eaf7343a21192fc29734428c1cc7bcd0162ccf365a5f2860e27c72c4e57245ed97bc3b141a4f99ba83b6a54996d86a46c8d637d7d6851453315c4da3b664352c03496cbd10468919a7e255a2d652b8c06bc4aeb9e6f95584c2bca9b9b1e23993b4b9496a629c297c22ccec61725bccaa729571d776346c35cdfbb2e7d3927a9b60eb1572c900b8b8202357437819c129e3cd66d21d7af55c5682b951deff475df1b3aae0699b1ca0b9ac8a054f2b3eadc7547b307d147cc56d92bbe274c7ce42f77919c38e858a3c724b4113da1829e20e607bee0a9b5216cb1cb7facc71d3b12ae0cd48bbf0444687c60fca7ab0db70b8dd80445b5b055350d002b30d66462202c91c55779800020b51547fc93b29379a4b74c2d4de3a69290a0e0a84f5f99418890017f0325759611c8f77f28bb7b12a556aa7a6792cba00ae2c272a1c322e36cc1fab9f5254d6a7b24c6c03cc4e20652508c41e0abd5842c1f26ba1d91b15d90764cbb5721009cf6b19840f4317c204c9de06f79d15e345791d866a0dc61c1ecf0951bb0cdcc86cc4204121425280ae80e86405c2db72ffd468ba1811546f9bb8cbaa08eb9bc43b4ca4351987874b1ce76130ac20b8a505fce250e0fab01e33b0b32294e78d9ba00474b1e7c948d9abe3874b9b8d19cff71145c41a53bc84c42b184a21376bf3670b02593c95a8c854a7047ac2dd020c53c9c6a4b88c313aaa190a9895e25cb3d02b62b7b5c7a5b710638009e3238dac827e852105c74afd80528c7514dc67573f6c50a19234626da0e040b4f7bc97954f93d42d78c02ac50c9b7a98964961bb80584eb05afc266ecc3250322621c736eadf3903cfa8cb9b2a68c17369bd9c8905602ad38be7c30bdb11b69e845c202c1063eeb5597f7bf2b05490dc0622fb24e499ba4240bca6aba7f232464ee956100ec8988664c967859eb89349d360017eacf8b3c2727195209b176dd21412cc09fc5c6c58fe343e2037027e1884ae50bc5b6385619bcdbcc185c53c065385efcbc133fd87439a247d56590a3c6bc345c39a6822e2005165119784becbf096396f4248670a5acbcb0b95645ac7c57a193583f73899f8112848689c478ab1cbad34a77677295f00b508baefb3a44a414625e099b12f619a038b63b89296ec82f58f7be74316892c345c460a7576ab11892a87231c3f47a8edc171349407ad7d6c409cc702e471e2f00a39ac7aee45b8c0d30a6679aaf902a22e8f885dcc4af21f183f181b0c99bae8fa942f4d23886486d02d179c236234f499b82507a2580c2ccd5c2c134b4f48678a8f4695ca903dde71a57934fad37657310af29caa9f24654e08b809a80aa227897d7605b79ba75d4bb1a2702d0fccaa0cdbb4101438aef8c196ac211aa408e01f77972c92ee78a00897bc3f8604250b7a1a2b904432b79d39a5d333629a4c9bee7070b8edc3096003f787320e3157155c30fb8cc7982c634fcd09e28db8576e61098928dbd30071f054245ec6e1595b29a422e7a6a2e93e4c512aa752bacb7f3690e146276f570b43ab21e34286270094147daac33e6361c9196275cb23eb3c57280c50daa640841691769a2ef836121a554153c837d073014ba61408380f11bbb2724ca8de52e70c255e334cfe3c80f7f2b6a4b2833615b9b987a1c2f976acf999e49a416dce24e7d46645c445401509459b4c484984f9fc21d5f472cefb31b7eba72df635e39f89dcdfb2d7d92a1173524d1e4afa0424d30b7aabfe38dde1a2603aa630c61666888a46acc5580c5076875a4b52c5e3944a9235ba31d27c3738859c207a10398be325422a2523b0dc412d3ea6101c3adca665bf250acecf3c2d0a05099336ade592747fcaa5092af3b294099e47b57c50bf4eaaf39a14e49aa7a827924e71a244306473dc2783b270eeb41a228311591b17480412dac9a21c0b96ad54bb9cc1661427cc9797b7ecf913e1e57003afba004082f9d77b270a301cd1910ef1762c2d294f6a2cfa5c3ad1a088a96215682fc7a09785ece2194cfab7c3d35618f5a891d03bd6f7a65c35029c49048aea19f88179856752a653a12151a6a8f02c6f93b9dfdb27604454f6e1413945a93ad033543f2bb47f6b2657355e09cabd6b1023bb7c2ad616f0e30c443167dbce22b6c38c379c78281e534dec17371522f2cac0cd5d99448ebc912678ff1a7b787b64f0fb9c3d6c76910ab8bf99014eea6c91fa3ce25920b6bfc63fa55200c781c77704c24a574c1ca0f90068d6f1396acb50c219b08e03a1faf392d82a1bb7f26aec454b06b49ce9c27b37e9b72edf80af182469759afe7d354bc018190f43431d700a6bc62f1844546b001d320753de901cfb159b249253dbf948f8117063d5dbc40c97e9290c47ea62dedcaa0ec9f62e8c88195d7ad50b14514fbe94a887554204da7a40dafbe72c5e15d39e9690000000000000000000000000000000000000000000000000000000000000000"
    "m":  "0000000000000000000000000000000000000000000000000000000000000000"
    "ct": "7bfebf5352fb2032acd204b20293471ff33933e993ad4b2fa6af618049276055feb7234f0de84e8096ee0a85d08e2e673b6b1f609a5cb60fb098f7f0975340fbdcbc6529b65be9ac5460890092e6a37ae229bfbd2c636cff55e9fa324ef38aec32d7816420ced2985eec5921f8dbda80cfb45087a331afd38d9baca8fc8510fc5c1f26ed1f7b7658179b2c75e8f1ec9bb0f382e2892498e7cece780d3a14a35c3adfdd0dfe144a1a2788c09f385ddeb37f964db88b94e8ca6fc28cc067f7db7df040abd96a4bfd20dc1b661cfb354e1598954bf094932596f172c41a2e16b55ad7978d7566932e35a23f9d2e67d29b725db01fd6ccc78d716a29b1ed8d4a6a56ddc0572beac63f490e10d2ade7ab4f197977116a3131ff4e840a63335a4417661362a1502ae7db613f16f97a819ae84baaa74b84a7c6ab29c3fe08ab326967f353219effe02335855ce0f13f037b321b4bdfeb9f48a2974afcb930dd6a05a0ec5d4c6cfcc9ab83de04d0c7bc884a250705bd95e3e1e24d26e1d14add6c8fe49ac870298a8825e5c275abfdb898ba76be128f5198b2c63852a94c25146820cbe2b1dc7f82c5ffa1debd24063261618756d088c1a4a4ae7fb2e653d3952514cc614085bc7c0823ea65d1e917a8dbbf1e9fdd3eb5b9100465c6f67f67a406eb6fa0809ca45f3c507041be655f8db47bcd4383ce764e48080a5d231909604f467f727f005993c7f030f01fdc7f722141b2896e76ef0f4fd2ae6b35aebbdccc7068420ac3ebff63a2f540dd5f3220b150d2e67663b5c3c1bb53c93dc3bc6a2b5317016e8437dc573c3a2a3b9f889ad64bf28b4d527f460fc65c21f4cd5be10460faae73fb69cf40d172a102087ae23942ded6bcc1e8080f2b918196e23b27f21b01f06a7dd66c722a14aeb8e9dede21f47f42fa57d18add236e016d8d02c718d0531dd4f8645da83cdf42609701254dd4e14ca89cafb700699ff6cdc2dfdc437c5652393b4eb304b01e53faad2a3355ec597f9dd133510e63f3d087d395b57305b4828d85b16bb976627f0822c408eb87cc82f0dc92fd2348df0d14f7a19ddeee383454e63b9bf8a395b1af4100c9b1ac94f8492018e3373ccbe5194854b0a76916272b0b723b1d1632dfd48a43a7dfe9655ba508d582cf6f4ca052e167b2091b92393583638b820817cd26445fb550be5be6be28464bbcfe2361a23c1f266a1c1fef691f0292eb7ad817ed47c3c1634ba09214da9a9d461b58737d12c58e96dea97b578f8afe5d9f6b24d989e6009eddb6e8ab03c19d340712961fec5607c89c5e35ba86c961d5b556e9aff3e9f541fcae8609dd3501d6db3c9080985c3e6fffe2040b15928231b28af7865c5cf990cc58c9a84127d1d8a55ee2e80689b4503e41a85918cd4b31f904523440d4dfb1b8b51dfe99136954d68b08e8720840544e70462e995eeac898fc5f6bd89190a84c6e9a8624bc25a2d96c574272a4bdf13a64b954c0bbe5288d9e7d1ad2805f4782864cdc38367401a0d30e7d8d576441d47e4870a7148896ec003002cdceae77f9a1e148fc87bad5f46010e24fbb00714448fea186a947d17dbee07db3137c89a340e119d1c7d9440b68e634872f1b8c9adae8abc9b5ef38c71e4f6f7fd03d1a3489bebeff6bc37060318911d32532fc0035808e3c119bb064bcced20ad52666a61dba9317885eafc70f061e33cb0c13797378c0d648661403fa756d097dcbe925a72006305ff1fea22fd61d4ce0ea9b02cf99f04f1eadb676915f6f1e9274f7a5136736b33322c931461e984ae917ac824dccfb6384ab89470ea6b8de603be51fd17d29ba13a487cdfb7d09707815b3389fe3010653a9775095f750831732faf8795a37b544e715486915ab79a94eb1617aec3469bd654a9d0626d059fb762e7b55b3e76b338196515a68e32a7ad0ad7bb07326fa2cb3d1d047ca0283055d6dc64a72fad559f696c4b135477f6f5965354b0c9c5d8b9a341f710cf645d378a7844cd5c7210afc53cb7ccfa5695efb254c69772b84235dbe7461ca9d4246ad118ec102c3bdf10045006587a18df8d224c28ff749f9f82472fa24683a9e4e918cd7993dc8bde5e31a12fd94f1ab49c1151fb9538403105e99179e3b3c63f3c00503fdedb0ff282fa8644171964e1f6eaa97772af521af0acebad3c4f2d7f120ef3ffb5069d98a2521ab06c426807e091f535f88"
    "sk": "760a9793cd6c81c3cdeb8c679ae7f5741caaa97452898345fc081fef29069885"
*/

// uint32_t seed_z[MLKEM_SEED_SIZE] = {0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000 };
// uint32_t seed_d[MLKEM_SEED_SIZE] = {0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000 };
// uint32_t msg[MLKEM_SEED_SIZE] = {0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000 };

uint32_t shared_key_array[MLKEM_SHAREDKEY_SIZE] = {0x93970A76, 0xC3816CCD, 0x678CEBCD, 0x74F5E79A, 0x74A9AA1C, 0x45838952, 0xEF1F08FC, 0x85980629 };

uint32_t ek[MLKEM_EK_SIZE] = {
    0x902C57B1, 0x02828B0B, 0x81377435, 0x3C9E129C, 
    0xD7216DD6, 0x68C555AF, 0xEF1D952B, 0x1BDF75F4, 
    0x9906AE3A, 0x9A0BCAB1, 0xF254A0C8, 0x75DCEAB3, 
    0xD107B347, 0xD956CC47, 0x4C27BE2B, 0x772FE47C, 
    0xE8389C91, 0x24C7A358, 0xA13D11B4, 0xE6209E82, 
    0xA9E0BE07, 0xB16C21B5, 0xC7AC7FCB, 0xAE123B1D, 
    0xBF8BD40C, 0x7C684404, 0xABA7FC60, 0x8D0BB70D, 
    0xB54504D8, 0x0D3555B0, 0xD6302B00, 0x2C206264, 
    0x7957C591, 0xB5200080, 0x93FC4715, 0xA47993B2, 
    0x4D2D4CB7, 0x9092A6E3, 0x4FA8E0A0, 0x8841995F, 
    0x037F0190, 0x11967525, 0x287FF7C8, 0xA5127BBB, 
    0x677AAA56, 0x0AA0CB92, 0xA172C2E2, 0x6CE322C3, 
    0xF5B9FAC1, 0x7B6A4D25, 0x3CC0C624, 0x5206E2C4, 
    0xE0418C50, 0x2C84D5AB, 0x1DBA261F, 0x905DB191, 
    0x57BB4C76, 0xF69C0021, 0xF44098B1, 0x4C207C31, 
    0x796FE09D, 0x57345ED1, 0xA066D891, 0xECC161DC, 
    0xB01B95F0, 0xCC86CCCD, 0x14120442, 0xE80A2825, 
    0x5C40860E, 0xFD2FB72D, 0x81A18B46, 0xBBF94615, 
    0x8EA0BA8C, 0xB443BCB9, 0x985143CA, 0xCEB17478,
    0xC20A1376, 0x5F508A0B, 0x0F0E25CE, 0x3BE301AB,
    0x4E29320B, 0x00BAD978, 0x7C1E4B47, 0xBE9A8D94,
    0xB8B97438, 0x71FF9CD1, 0xA5415C14, 0x424CC83B,
    0x13A284B1, 0x7036BF76, 0xC99325B0, 0x4A858C5A,
    0x2DAC4770, 0x3CC520D0, 0x884B6A9C, 0xA1AA13C3,
    0x5E89A990, 0x023DCB25, 0x5C7B2BB6, 0x06715B7A,
    0x329E0038, 0x27C8DA38, 0x5C1052E8, 0x05D8AF74,
    0x4D51C728, 0xF67375C6, 0x23190AC5, 0x0EDA2646,
    0x7B4F0B04, 0xF95479C9, 0x8CD7423D, 0xC950AC02,
    0x6489A9B7, 0x05B81B96, 0xAF05EB84, 0xC3EC66C2,
    0x62220325, 0xAD6E731C, 0xFA3C90F3, 0xA6B2B98C,
    0x9B36178C, 0x5690C8D9, 0xBE38AD02, 0xB1BD307C,
    0x45E8691B, 0x06C102C2, 0x9755EB3E, 0x052BBFF7,
    0x62C00D49, 0x494EB22F, 0x0B24A49B, 0x7FBA6ACA,
    0xEE642423, 0xEC006195, 0x4C668889, 0xEB597896,
    0x369D3489, 0xCFEA1700, 0x27273C8B, 0xB1095219,
    0x4121DD76, 0xC59FC02C, 0xE38FC5C6, 0x7003E243,
    0x4A88E127, 0xB6C50BE5, 0xBC195638, 0x5C18CCDB,
    0x3865C053, 0x13BCFC5E, 0x3974D83F, 0x65D547A2,
    0xBCC6A390, 0xA6395C34, 0x05202E82, 0x78195116,
    0x09BFEC4B, 0x24F49663, 0xACA57086, 0x56B9B0BC,
    0x577CAC45, 0x3F5893A1, 0x819F8973, 0x89868412,
    0x1CAB78C4, 0x774AD3BA, 0xF0957267, 0xAE8B500B,
    0xA4443AFB, 0x095E6214, 0x19F6129B, 0x3BB638A0,
    0xC86E2989, 0xBEF7582F, 0x92683174, 0x60C445C3,
    0xB16A57A7, 0x72A89218, 0x7AF4C331, 0x1317DC8E,
    0xD77A4049, 0xCC09C4D6, 0x1E472E70, 0x9AA3002F,
    0x5BE4AEC7, 0xA6300D8C, 0x90AF9A67, 0xF8E8222A,
    0xAFC4DC85, 0xF183F121, 0x9BC9B081, 0x42A98FAE,
    0x8638D2F4, 0xD1026D48, 0x2336C279, 0x829B494F,
    0x80257A50, 0xC2D5CCC2, 0xF4B434C1, 0xF4A87886,
    0x03A95C69, 0x571AE7DD, 0x37AD4F93, 0xAF107365,
    0xF2A9CA29, 0x8BE05446, 0xAA809A80, 0xD7977822,
    0xBA795B60, 0x1ABBD475, 0xFCD00227, 0xBBCDA0CA,
    0x8A430141, 0x6A198CEF, 0x40AA11C2, 0x79F7018E,
    0xE72EC972, 0x7B89008A, 0x4260F8C3, 0xA2A1B750,
    0x2B4304B9, 0x5D9AD379, 0xA4293633, 0x07E7BEC9,
    0x30DC8E0B, 0x783F0096, 0x15E32073, 0x0FC35571,
    0x8279CCB8, 0xD0FC34C6, 0x85DB289E, 0x9810E676,
    0x30BD8D92, 0x42051F07, 0x156EEC45, 0x429AB295,
    0x2E6A7A2E, 0x12C5E493, 0xAC2B75AA, 0x0E69F3B7,
    0xF5766214, 0xB23AB470, 0x6228341E, 0x47410970,
    0xE633ACDA, 0x96911C36, 0x3EB25C27, 0x8072C5B3,
    0x64AA0DC5, 0x17694108, 0x83EFA269, 0x54A52161,
    0x7D833C15, 0xBA143007, 0x80834061, 0x27BB1BF1,
    0xE58DCA24, 0x55C2702E, 0xE3CF34E3, 0x2B7F0FC8,
    0x33284B6A, 0x989B5B61, 0x972F1C7A, 0x9E99CF6A,
    0xDC16A449, 0x467D4EE2, 0x54445C64, 0x59945001,
    0x9884C4B4, 0x1DC29F4F, 0xEF2C475F, 0xBA7E1BB3,
    0x5E63DF72, 0xCD9DF839, 0x927D2DFB, 0x243517A1,
    0xA0AFE4D1, 0xB7304D42, 0x8DE3BFAA, 0x03261ADE,
    0x610C63AA, 0xA4886866, 0x8055CC6A, 0x756807C5,
    0x5E2CB5A4, 0x23A94439, 0x271DA35B, 0x598873C3,
    0x03A107C2, 0x5432BE98, 0x3B52A222, 0xD312C40D,
    0xC30161EA, 0x5B66CAAD, 0xECAC50F2, 0xA0D0C2F3,
    0x6A339950, 0x472759DE, 0x9250AAFC, 0x40293BAF,
    0x577BE499, 0xEAF40BC5, 0x4EA139AF, 0x827AAA49,
    0x1AE72479, 0x47064324, 0x3B78C23D, 0x41EB0E27,
    0x153128A2, 0x8074B191, 0x9AAC2D41, 0x6AB9C021,
    0xCCB94BD5, 0x7C426116, 0x7E7B79C9, 0x1E3E91CF,
    0xFB3A0057, 0x2F0804A0, 0x70B2779D, 0x19CD01A3,
    0x6217EF10, 0xF694D2C2, 0xC3A5CFA2, 0x8A081AAD, 
    0x82562196, 0x78097AFC, 0x9421CE5E, 0x3D7CABCF,
    0x5A8F6135, 0xBD031D89, 0xC3657A6F, 0x90C42950,
    0x9FA1AE48, 0x56981788, 0x3A652A75, 0x6A1A1512,
    0xF9C6028F, 0xB2FD9D3B, 0x4F450476, 0x9413146E,
    0x03AD935A, 0xBBF24335, 0x65B2F647, 0x9CE05573,
    0x02B1D6AB, 0xADC2B73B, 0x300E6F61, 0x7D1643C4,
    0x6C2BE2BC, 0xC779C338, 0x34E58182, 0x7173C1DE,
    0xAC2C2F52, 0x94D9D50C, 0x12C9EB48, 0xA7F18F67,
    0x4FB687B7, 0xD6C3B90F, 0xAB1069C7, 0x1490F98B,
    0x1FC9A6EE, 0x9225CEA3, 0x63FC6B0B, 0x0C2055FA,
    0x70771C78, 0x74A5244C, 0x900FCAC1, 0x136F8D06,
    0x0CB5AC96, 0xE0089B21, 0x39AF1F3A, 0xBBA1822D,
    0xC4AE267F, 0x496BB054, 0xB3279CCE, 0xED729B7E,
    0x82F10AF8, 0xAF599746, 0xBC54D3E7, 0xF4908101,
    0x00D73134, 0xF162BCA6, 0xB0464584, 0x7520D301,
    0xCF01E93D, 0x49B259B1, 0x94BF3D25, 0x0617818F,
    0x40BC5D3D, 0x90927EC9, 0x2DA67EC4, 0xECA0CAED
    };

uint32_t dk[MLKEM_DK_SIZE] = {
    0x777FB58B, 0x8C15755B, 0x34F8125A, 0xD3943A5D, 
    0x86409F85, 0x530C5CA9, 0x36146272, 0x6AFC84D0, 
    0x63447A19, 0xEBC25B16, 0x7012A3D7, 0x5D31ABC3, 
    0x215F91F7, 0xC8826F5C, 0x198BF418, 0xEEC333F1, 
    0xA401BFF3, 0x36B20E76, 0x2875E77E, 0xA2568B49, 
    0x0F625217, 0x1CCF63D4, 0x3C988114, 0x9C9C8487, 
    0x56AF3C9F, 0x4BA306F7, 0x07C3D242, 0xD9855206, 
    0xABF41ECC, 0x6A11CCA7, 0xFF1A502D, 0x09ABB180, 
    0x15982D49, 0x4327702C, 0x82E64FC7, 0x0288FF53, 
    0xEACB34F3, 0x97164961, 0x49070AAA, 0xE2BFA91B, 
    0xB334896B, 0x090A90B7, 0xECB308BD, 0xE1F40346, 
    0x2E528F66, 0x817F03A3, 0x34163AC2, 0xB6545264, 
    0x4B860182, 0xF6FC3992, 0x92D012C9, 0x19AAE88B, 
    0x774DBB41, 0xA2901EA1, 0x199D15AF, 0xF3040C07, 
    0x2CB5E6CC, 0x8A492CBF, 0xD5788225, 0x3276E8BC, 
    0xD17911F7, 0x7771C048, 0x031C2F7C, 0xDD1DCA2F, 
    0xCBD896A8, 0xC0D22448, 0x5E51A3ED, 0xF8880CF9, 
    0x1523E775, 0x5A58579B, 0x47831038, 0x90E2397B, 
    0x4E3FE3F1, 0x455EA4C6, 0x382BFCC2, 0x13BF928D,
    0xCCA4A5A3, 0x19068897, 0x431A52FE, 0x6C425FF6,
    0xBCA6F195, 0xE2458A1D, 0xEC823D09, 0xBFD5C7B4,
    0xA96C1CF1, 0x5BF3C759, 0x803CAB93, 0x2D4C1110,
    0xEA8D8482, 0x3BE2AA38, 0x511756AC, 0x8A902A5B,
    0x558A55B0, 0xEB3637E8, 0x89A188B3, 0x740100B6,
    0x1335271A, 0xD0500672, 0x0D963B9E, 0x35B54300,
    0xF55EA6F8, 0x55217783, 0x66C287B3, 0x96BB09D2,
    0xC9F11D3D, 0x1CAE13E7, 0x0C532CC4, 0x8880348B,
    0x98A237FD, 0x961ECF00, 0x6506C422, 0x1E918BD0,
    0x0AF284CC, 0x4636B067, 0xA1C1E3D2, 0x528C19F0,
    0x5C5B880C, 0x37BCF0C1, 0xA80416C2, 0x8FE3BD0B,
    0xA1852CB0, 0xD5F918D8, 0x7996F34E, 0x5D82E863,
    0x17A14389, 0x9B511E5C, 0xBA62DACF, 0x27CFA125,
    0x37B39717, 0xD0C1B039, 0xAAFFBCCC, 0x9B44B220,
    0x9466A46C, 0x98D6CA54, 0x9A3B913D, 0x275D688D,
    0x78911924, 0x454C73AC, 0x44AC572C, 0x252A5101,
    0x14B9728A, 0x4A41F662, 0xC801C937, 0x78267FAD,
    0xFFC12690, 0xA7457450, 0x7938B72D, 0x3982EAD7,
    0x692B78B2, 0xC1753C37, 0x619CC87D, 0x25FB3F66,
    0xA5830540, 0x0F184A9B, 0x890C6DA4, 0x50BA0036,
    0x30842AEF, 0xB686AC1C, 0x1A20E99D, 0x83904858,
    0x52BA4D2C, 0xBDC38E58, 0xEF8624A6, 0xC3B16877,
    0xC597689C, 0xC1651583, 0x95B7703C, 0x34E28203,
    0x74117395, 0xA1C784DA, 0x7EF4E8B0, 0x26069306,
    0x53E5C710, 0xB72C9BB1, 0xBFAC4434, 0x49A47E7C,
    0x71688C9C, 0xB4557206, 0x29D5BA06, 0x954A0419,
    0xECC8C6F5, 0x678039C0, 0x7F5142B9, 0xFE3BF0C8,
    0xC7E26118, 0x294B6E0F, 0x43BA521A, 0x36EEBE01,
    0xA603729A, 0x963B4CDF, 0xA7CD79D7, 0xAD5B3BAE,
    0xA4470A2C, 0x30C6B330, 0x3B5A07CA, 0x40A47205,
    0x01E5261A, 0x1CD2A383, 0x8C736340, 0xEAD57B69,
    0x280129CA, 0x80149827, 0xF4718630, 0x6AF19E73,
    0x2FA84536, 0x86F77269, 0xB6A2083D, 0x6139A3E2,
    0x500D7E61, 0x904B2F2E, 0x36155B41, 0x42297F0B,
    0xB0117702, 0x336748C7, 0x115E25DB, 0x48295A21,
    0xC5B862EB, 0x7B763B54, 0x87E09235, 0xE414E106,
    0x807D29E5, 0xB7D4A711, 0x71CF0976, 0x61890443,
    0xB7E75B8B, 0x6D35B307, 0xC5E9BDE9, 0x2AF679C1,
    0x74C7C67F, 0xBCC1C460, 0x5A939DBF, 0xE204D896,
    0xA801181B, 0x874A4C27, 0x60181760, 0x8BB84572,
    0x03566E88, 0xDE02E0D1, 0x447FC681, 0x4AA3D38B,
    0xC550D4E9, 0x1503303A, 0xC5A7AD9B, 0xC6195046,
    0x18F51D72, 0x27811386, 0x7E82FA8E, 0x8870AB4B,
    0x46DBD4AA, 0xE4617972, 0x1CF23B86, 0x67F6BCAD,
    0x3526D2A4, 0x4434CBE7, 0x655093AA, 0x9B28ABC0,
    0x25449858, 0x94DA6281, 0x24A8FCD3, 0x25CE2F4C,
    0x0139FE4E, 0x91CC6341, 0xC19B4484, 0x7BD7B232,
    0x63C8D276, 0x9B6568BB, 0x31F8BCCF, 0x46C66C9F,
    0x46B581D6, 0x5FDC1459, 0x22B4E6EB, 0x42379738,
    0x0F55BD5C, 0x2D763B01, 0x6347863A, 0x1920BB79,
    0x08565B39, 0x9C140D71, 0x9BFB686C, 0x7C9E865C,
    0x019A9045, 0xC86A3077, 0x567CEC2C, 0xC9C93084,
    0xCD03B736, 0x4C15F266, 0xD0686452, 0xC5592704,
    0x97C85C89, 0xE6497F25, 0x9BC2D209, 0xD894E3AB,
    0x964755F9, 0x94241822, 0x0B4633AE, 0x08395DA1,
    0x1564C2B7, 0x5ACB3817, 0x731C3760, 0x240B1BC8,
    0xEAAED072, 0x2C0374C7, 0x6E5C211A, 0xA969EC34,
    0xB35B0B84, 0x3DE1CB04, 0x4564E5B6, 0x05BE1F07,
    0x2F1AA467, 0xC95F40D2, 0x978F2AC1, 0xC0570454,
    0xA6A601F5, 0xB7A6C94C, 0x40A0587D, 0x13C50555,
    0x950FB7B4, 0xAEEC0536, 0xEB2B6833, 0x864BA514,
    0x91E70EC2, 0x7A925CBA, 0x9C3B3622, 0x97A3C277,
    0x78059B6E, 0x20C2CC77, 0x5643380F, 0xA8C3B2A6,
    0x40362F26, 0xB56114C6, 0xE20DB58A, 0xB8AD2983,
    0xC336A754, 0xC5507BF3, 0x70C3A534, 0x0E8C4842,
    0xFFB104A8, 0xD969B193, 0x69B35951, 0x443AA0D1,
    0xBCB7C2C1, 0x3A887293, 0x7961E713, 0xB6FB7250,
    0x3C0493BC, 0x571E803B, 0xA448B8B7, 0x98479C14,
    0x2425F7AF, 0xF77E8E02, 0x2EC6A177, 0xAF3E0166,
    0x11A24373, 0x7329FC92, 0xCCC12844, 0x6201CD7B,
    0xA565F3CC, 0x270E86F2, 0x574E2CC7, 0x7BD95E24,
    0xA441B1C3, 0x3BA89BF9, 0x6D99546A, 0x8D6CA486,
    0x687D7D63, 0x15334551, 0x663BDAC4, 0x34C05243,
    0x04D1CB96, 0x7E9A9168, 0x652D5A25, 0xBC068C2B,
    0x6F9EEB4A, 0x2B4C5895, 0x1E9B9BCA, 0x4B3B9923,
    0x29A69694, 0x2CC297C2, 0x2517C6CE, 0x29A7CABC,
    0x63771D57, 0xDF5CC346, 0x397D2EBB, 0x0EB6A927,
    0x902C57B1, 0x02828B0B, 0x81377435, 0x3C9E129C,
    0xD7216DD6, 0x68C555AF, 0xEF1D952B, 0x1BDF75F4,
    0x9906AE3A, 0x9A0BCAB1, 0xF254A0C8, 0x75DCEAB3,
    0xD107B347, 0xD956CC47, 0x4C27BE2B, 0x772FE47C,
    0xE8389C91, 0x24C7A358, 0xA13D11B4, 0xE6209E82,
    0xA9E0BE07, 0xB16C21B5, 0xC7AC7FCB, 0xAE123B1D,
    0xBF8BD40C, 0x7C684404, 0xABA7FC60, 0x8D0BB70D,
    0xB54504D8, 0x0D3555B0, 0xD6302B00, 0x2C206264,
    0x7957C591, 0xB5200080, 0x93FC4715, 0xA47993B2,
    0x4D2D4CB7, 0x9092A6E3, 0x4FA8E0A0, 0x8841995F, 
    0x037F0190, 0x11967525, 0x287FF7C8, 0xA5127BBB,
    0x677AAA56, 0x0AA0CB92, 0xA172C2E2, 0x6CE322C3,
    0xF5B9FAC1, 0x7B6A4D25, 0x3CC0C624, 0x5206E2C4,
    0xE0418C50, 0x2C84D5AB, 0x1DBA261F, 0x905DB191,
    0x57BB4C76, 0xF69C0021, 0xF44098B1, 0x4C207C31,
    0x796FE09D, 0x57345ED1, 0xA066D891, 0xECC161DC,
    0xB01B95F0, 0xCC86CCCD, 0x14120442, 0xE80A2825,
    0x5C40860E, 0xFD2FB72D, 0x81A18B46, 0xBBF94615,
    0x8EA0BA8C, 0xB443BCB9, 0x985143CA, 0xCEB17478,
    0xC20A1376, 0x5F508A0B, 0x0F0E25CE, 0x3BE301AB,
    0x4E29320B, 0x00BAD978, 0x7C1E4B47, 0xBE9A8D94,
    0xB8B97438, 0x71FF9CD1, 0xA5415C14, 0x424CC83B,
    0x13A284B1, 0x7036BF76, 0xC99325B0, 0x4A858C5A,
    0x2DAC4770, 0x3CC520D0, 0x884B6A9C, 0xA1AA13C3,
    0x5E89A990, 0x023DCB25, 0x5C7B2BB6, 0x06715B7A,
    0x329E0038, 0x27C8DA38, 0x5C1052E8, 0x05D8AF74,
    0x4D51C728, 0xF67375C6, 0x23190AC5, 0x0EDA2646,
    0x7B4F0B04, 0xF95479C9, 0x8CD7423D, 0xC950AC02,
    0x6489A9B7, 0x05B81B96, 0xAF05EB84, 0xC3EC66C2,
    0x62220325, 0xAD6E731C, 0xFA3C90F3, 0xA6B2B98C,
    0x9B36178C, 0x5690C8D9, 0xBE38AD02, 0xB1BD307C,
    0x45E8691B, 0x06C102C2, 0x9755EB3E, 0x052BBFF7,
    0x62C00D49, 0x494EB22F, 0x0B24A49B, 0x7FBA6ACA,
    0xEE642423, 0xEC006195, 0x4C668889, 0xEB597896,
    0x369D3489, 0xCFEA1700, 0x27273C8B, 0xB1095219,
    0x4121DD76, 0xC59FC02C, 0xE38FC5C6, 0x7003E243,
    0x4A88E127, 0xB6C50BE5, 0xBC195638, 0x5C18CCDB,
    0x3865C053, 0x13BCFC5E, 0x3974D83F, 0x65D547A2,
    0xBCC6A390, 0xA6395C34, 0x05202E82, 0x78195116,
    0x09BFEC4B, 0x24F49663, 0xACA57086, 0x56B9B0BC,
    0x577CAC45, 0x3F5893A1, 0x819F8973, 0x89868412,
    0x1CAB78C4, 0x774AD3BA, 0xF0957267, 0xAE8B500B,
    0xA4443AFB, 0x095E6214, 0x19F6129B, 0x3BB638A0,
    0xC86E2989, 0xBEF7582F, 0x92683174, 0x60C445C3,
    0xB16A57A7, 0x72A89218, 0x7AF4C331, 0x1317DC8E,
    0xD77A4049, 0xCC09C4D6, 0x1E472E70, 0x9AA3002F,
    0x5BE4AEC7, 0xA6300D8C, 0x90AF9A67, 0xF8E8222A,
    0xAFC4DC85, 0xF183F121, 0x9BC9B081, 0x42A98FAE,
    0x8638D2F4, 0xD1026D48, 0x2336C279, 0x829B494F,
    0x80257A50, 0xC2D5CCC2, 0xF4B434C1, 0xF4A87886,
    0x03A95C69, 0x571AE7DD, 0x37AD4F93, 0xAF107365,
    0xF2A9CA29, 0x8BE05446, 0xAA809A80, 0xD7977822,
    0xBA795B60, 0x1ABBD475, 0xFCD00227, 0xBBCDA0CA,
    0x8A430141, 0x6A198CEF, 0x40AA11C2, 0x79F7018E,
    0xE72EC972, 0x7B89008A, 0x4260F8C3, 0xA2A1B750,
    0x2B4304B9, 0x5D9AD379, 0xA4293633, 0x07E7BEC9,
    0x30DC8E0B, 0x783F0096, 0x15E32073, 0x0FC35571,
    0x8279CCB8, 0xD0FC34C6, 0x85DB289E, 0x9810E676,
    0x30BD8D92, 0x42051F07, 0x156EEC45, 0x429AB295,
    0x2E6A7A2E, 0x12C5E493, 0xAC2B75AA, 0x0E69F3B7,
    0xF5766214, 0xB23AB470, 0x6228341E, 0x47410970,
    0xE633ACDA, 0x96911C36, 0x3EB25C27, 0x8072C5B3,
    0x64AA0DC5, 0x17694108, 0x83EFA269, 0x54A52161,
    0x7D833C15, 0xBA143007, 0x80834061, 0x27BB1BF1,
    0xE58DCA24, 0x55C2702E, 0xE3CF34E3, 0x2B7F0FC8,
    0x33284B6A, 0x989B5B61, 0x972F1C7A, 0x9E99CF6A,
    0xDC16A449, 0x467D4EE2, 0x54445C64, 0x59945001,
    0x9884C4B4, 0x1DC29F4F, 0xEF2C475F, 0xBA7E1BB3,
    0x5E63DF72, 0xCD9DF839, 0x927D2DFB, 0x243517A1,
    0xA0AFE4D1, 0xB7304D42, 0x8DE3BFAA, 0x03261ADE,
    0x610C63AA, 0xA4886866, 0x8055CC6A, 0x756807C5,
    0x5E2CB5A4, 0x23A94439, 0x271DA35B, 0x598873C3,
    0x03A107C2, 0x5432BE98, 0x3B52A222, 0xD312C40D,
    0xC30161EA, 0x5B66CAAD, 0xECAC50F2, 0xA0D0C2F3,
    0x6A339950, 0x472759DE, 0x9250AAFC, 0x40293BAF,
    0x577BE499, 0xEAF40BC5, 0x4EA139AF, 0x827AAA49,
    0x1AE72479, 0x47064324, 0x3B78C23D, 0x41EB0E27,
    0x153128A2, 0x8074B191, 0x9AAC2D41, 0x6AB9C021,
    0xCCB94BD5, 0x7C426116, 0x7E7B79C9, 0x1E3E91CF,
    0xFB3A0057, 0x2F0804A0, 0x70B2779D, 0x19CD01A3,
    0x6217EF10, 0xF694D2C2, 0xC3A5CFA2, 0x8A081AAD,
    0x82562196, 0x78097AFC, 0x9421CE5E, 0x3D7CABCF,
    0x5A8F6135, 0xBD031D89, 0xC3657A6F, 0x90C42950,
    0x9FA1AE48, 0x56981788, 0x3A652A75, 0x6A1A1512,
    0xF9C6028F, 0xB2FD9D3B, 0x4F450476, 0x9413146E,
    0x03AD935A, 0xBBF24335, 0x65B2F647, 0x9CE05573,
    0x02B1D6AB, 0xADC2B73B, 0x300E6F61, 0x7D1643C4,
    0x6C2BE2BC, 0xC779C338, 0x34E58182, 0x7173C1DE,
    0xAC2C2F52, 0x94D9D50C, 0x12C9EB48, 0xA7F18F67,
    0x4FB687B7, 0xD6C3B90F, 0xAB1069C7, 0x1490F98B,
    0x1FC9A6EE, 0x9225CEA3, 0x63FC6B0B, 0x0C2055FA,
    0x70771C78, 0x74A5244C, 0x900FCAC1, 0x136F8D06,
    0x0CB5AC96, 0xE0089B21, 0x39AF1F3A, 0xBBA1822D,
    0xC4AE267F, 0x496BB054, 0xB3279CCE, 0xED729B7E,
    0x82F10AF8, 0xAF599746, 0xBC54D3E7, 0xF4908101,
    0x00D73134, 0xF162BCA6, 0xB0464584, 0x7520D301,
    0xCF01E93D, 0x49B259B1, 0x94BF3D25, 0x0617818F,
    0x40BC5D3D, 0x90927EC9, 0x2DA67EC4, 0xECA0CAED,
    0xC8E8629F, 0xADD79581, 0x1445B150, 0x884AE9FB,
    0x4D205475, 0xAF0DA4A7, 0xE1C572BE, 0x69E9395D,
    0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000
};

uint32_t ciphertext[MLKEM_CIPHERTEXT_SIZE] = {
    0x53BFFE7B, 0x3220FB52, 0xB204D2AC, 0x1F479302, 
    0xE93339F3, 0x2F4BAD93, 0x8061AFA6, 0x55602749, 
    0x4F23B7FE, 0x804EE80D, 0x850AEE96, 0x672E8ED0, 
    0x601F6B3B, 0x0FB65C9A, 0xF0F798B0, 0xFB405397, 
    0x2965BCDC, 0xACE95BB6, 0x00896054, 0x7AA3E692, 
    0xBDBF29E2, 0xFF6C632C, 0x32FAE955, 0xEC8AF34E, 
    0x6481D732, 0x98D2CE20, 0x2159EC5E, 0x80DADBF8, 
    0x8750B4CF, 0xD3AF31A3, 0xA8AC9B8D, 0xFC1085FC, 
    0xED261F5C, 0x58767B1F, 0x752C9B17, 0x9BECF1E8, 
    0xE282F3B0, 0xE7982489, 0x0D78CECE, 0x5CA3143A, 
    0x0DDDDF3A, 0x1A4A14FE, 0x9FC08827, 0xB3DE5D38, 
    0xB84D967F, 0xCAE8948B, 0xC08CC26F, 0x7DDBF767, 
    0xD9AB40F0, 0x20FD4B6A, 0x1C661BDC, 0x154E35FB, 
    0xF04B9598, 0x96259394, 0x1AC472F1, 0x5AB5162E, 
    0x758D97D7, 0x352E9366, 0x2E9D3FA2, 0x729BD267, 
    0xD61FB05D, 0x718DC7CC, 0xEDB1296A, 0x566A4A8D, 
    0x2B57C0DD, 0x493FC6EA, 0xADD2100E, 0x194FABE7, 
    0x6A117779, 0x4EFF3131, 0x33630A84, 0x6617445A, 
    0x50A16213, 0x61DBE72A, 0x7AF9163F, 0x4BE89A81,
    0x844BA7AA, 0x29ABC6A7, 0xAB08FEC3, 0xF3676932,
    0xFF9E2153, 0x853523E0, 0x3FF1E05C, 0x1B327B03,
    0x9FEBDF4B, 0x4A97A248, 0xDD30B9FC, 0xECA0056A,
    0xFC6C4C5D, 0xDE83ABC9, 0xBCC7D004, 0x07254A88,
    0xE395BD05, 0x264DE2E1, 0xDD4AD1E1, 0x9AE48F6C,
    0x8A2970C8, 0xC2E52588, 0xB8FDAB75, 0xBE76BA98,
    0x98518F12, 0x5238C6B2, 0x14254CA9, 0xE2CB2068,
    0x827FDCB1, 0xDEA1FFC5, 0x320624BD, 0x56876161,
    0xA4C188D0, 0xB27FAEA4, 0x95D353E6, 0x61CC1425,
    0x7CBC8540, 0x65EA2308, 0xA817E9D1, 0x9F1EBFDB,
    0xB9B53EDD, 0xC6650410, 0xA4677FF6, 0xA06FEB06,
    0x5FA49C80, 0x4170503C, 0x8D5F65BE, 0x43CD7BB4,
    0x4E76CE83, 0x5D0A0848, 0x60091923, 0x727F464F,
    0x9359007F, 0xF030F0C7, 0x727FDC1F, 0x89B24121,
    0x0FEF766E, 0x6BAED24F, 0xDCBBAE35, 0x426870CC,
    0xFFEBC30A, 0x40F5A263, 0x20325FDD, 0xE6D250B1,
    0xC3B56376, 0xC953BBC1, 0x6ABCC33D, 0x0117532B,
    0xDC37846E, 0x2A3A3C57, 0x9A889F3B, 0x8BF24BD6,
    0x467F524D, 0x215CC60F, 0xE15BCDF4, 0xAEFA6004,
    0xCF69FB73, 0xA172D140, 0xE27A0802, 0xD6DE4239,
    0x08E8C1BC, 0x81912B0F, 0x273BE296, 0xF0011BF2,
    0x6CD67D6A, 0xAE142A72, 0xDEDEE9B8, 0x427FF421,
    0x8AD157FA, 0x016E23DD, 0xC7028D6D, 0x1D53D018,
    0x5D64F8D4, 0x42DF3CA8, 0x25019760, 0x4CE1D44D,
    0xB7AF9CA8, 0xF69F6900, 0xDCDFC2CD, 0x52567C43,
    0xB34E3B39, 0x531EB004, 0x332AADFA, 0x7F59EC55,
    0x5133D19D, 0xD0F3630E, 0xB595D387, 0x82B40573,
    0x6BB1858D, 0x7F6276B9, 0x08C42208, 0x82CC87EB,
    0xFD92DCF0, 0x0DDF4823, 0x9DA1F714, 0x3438EEDE,
    0x9B3BE654, 0xB195A3F8, 0xC90041AF, 0xF894ACB1,
    0xE3182049, 0xE5CB3C37, 0xB0544819, 0x271669A7,
    0x3B720B2B, 0xDF32161D, 0xA7438AD4, 0x5B65E9DF,
    0x82D508A5, 0xA04C6FCF, 0xB267E152, 0x39921B09,
    0x8B638335, 0xCD170882, 0xB55F4426, 0xE65BBE50,
    0x4B4628BE, 0x6123FEBC, 0x261F3CA2, 0xEF1F1C6A,
    0x92021F69, 0x17D87AEB, 0xC1C347ED, 0x92A04B63,
    0x9D9ADA14, 0x73581B46, 0x8EC5127D, 0x7BA9DE96,
    0xFE8A8F57, 0x246B9F5D, 0x00E689D9, 0xE8B6DD9E,
    0x9DC103AB, 0x96120734, 0x0756EC1F, 0x355E9CC8,
    0x61C986BA, 0xE956B5D5, 0xF5E9F3AF, 0x86AEFC41,
    0x0135DD09, 0x903CDBD6, 0x3E5C9880, 0x04E2FF6F,
    0x8292150B, 0xF78AB231, 0xF95C5C86, 0xC958CC90,
    0xD12741A8, 0xE25EA5D8, 0xB48906E8, 0xA8413E50,
    0x4BCD1859, 0x5204F931, 0xDFD44034, 0x1DB5B8B1,
    0x691399FE, 0x088BD654, 0x400872E8, 0x46704E54,
    0xEA5E992E, 0x5FFC98C8, 0x9091D86B, 0x9A6E4CA8,
    0x25BC2486, 0x576CD9A2, 0xBDA47242, 0xB9643AF1,
    0xE5BBC054, 0x7D9E8D28, 0x5F80D21A, 0x4C868247,
    0x743638DC, 0x0ED3A001, 0x64578D7D, 0x487ED441,
    0x8814A770, 0x3000EC96, 0xAECECD02, 0xE1A1F977,
    0xBA87FC48, 0x1060F4D5, 0x00BB4FE2, 0xFE484471,
    0x47A986A1, 0xE0BE7DD1, 0x7C13B37D, 0xE140A389,
    0xD9C7D119, 0xE6680B44, 0x1B2F8734, 0xE8DA9A8C,
    0xEFB5C9AB, 0x4F1EC738, 0x3DD07F6F, 0xBE89341A,
    0xC36BFFBE, 0x89316070, 0x3225D311, 0x803500FC,
    0x9B113C8E, 0xCEBC64B0, 0x26D50AD2, 0xBA1DA666,
    0x5E881793, 0x060FC7AF, 0x0CCB331E, 0x78737913,
    0x6648D6C0, 0x75FA0314, 0xCB7D096D, 0x20A725E9,
    0xF15F3006, 0xD62FA2FE, 0xEAE04C1D, 0x99CF029B,
    0xAD1E4FF0, 0x5F9176B6, 0x74921E6F, 0x6713A5F7,
    0x2233B336, 0x1E4631C9, 0x17E94A98, 0xCC4D82AC,
    0xAB8463FB, 0xA60E4789, 0x3B60DEB8, 0x7DD11FE5,
    0xA413BA29, 0x7DFBCD87, 0x15787009, 0xE39F38B3,
    0xA9530601, 0xF7955077, 0x32178350, 0x5A79F8FA,
    0xE744B537, 0x15694815, 0x4EA979AB, 0xEC7A61B1,
    0x65BD6934, 0x26069D4A, 0x76FB59D0, 0xB3557B2E,
    0x81336BE7, 0x685A5196, 0xD07A2AE3, 0x73B07BAD,
    0xB32CFA26, 0xCA47D0D1, 0x5D058302, 0x724AC66D,
    0xF659D5FA, 0x35B1C496, 0x596F7F47, 0x0C4B3565,
    0x9A8B5D9C, 0x0C711F34, 0x78D345F6, 0xD54C84A7,
    0xFC0A21C7, 0xCF7CCB53, 0xFB5E69A5, 0x77694C25,
    0x5D23842B, 0xCA6174BE, 0xAD46429D, 0x02C18E11,
    0x00F1BDC3, 0x87650045, 0xD2F88DA1, 0xF78FC224,
    0x24F8F949, 0x6824FA72, 0x914E9E3A, 0x3D99D78C,
    0xE3E5BDC8, 0x94FD121A, 0xC149ABF1, 0x53B91F15,
    0x5E100384, 0x3B9E1799, 0xC0F3633C, 0xEDFD0305,
    0x2F28FFB0, 0x714164A8, 0x6E1F4E96, 0x2A7797AA,
    0x0AAF21F5, 0xC4D3BACE, 0x20F1D7F2, 0x50FB3FEF,
    0x258AD969, 0xC406AB21, 0x097E8026, 0x885F531F
};

void main() {

    mlkem_seed seed;
    mlkem_msg msg;
    mlkem_shared_key shared_key;
    uint32_t abr_entropy[ABR_ENTROPY_SIZE];

    VPRINTF(LOW, "----------------------------\n");
    VPRINTF(LOW, " Running MLKEM Smoke Test !!\n");
    VPRINTF(LOW, "----------------------------\n");

    //Call interrupt init
    init_interrupts();

    seed.kv_intf = FALSE;
    for (int i = 0; i < MLKEM_SEED_SIZE; i++) {
        seed.data[0][i] = 0;
        seed.data[1][i] = 0;
    }

    msg.kv_intf = FALSE;
    for (int i = 0; i < MLKEM_MSG_SIZE; i++) {
        msg.data[i] = 0;
    }

    for (int i = 0; i < ABR_ENTROPY_SIZE; i++) {
        abr_entropy[i] = 0;
    }

    shared_key.kv_intf = FALSE;
    for (int i = 0; i < MLKEM_SHAREDKEY_SIZE; i++) {
        shared_key.data[i] = shared_key_array[i];
    }
   
    mlkem_keygen_check(seed, abr_entropy, ek, dk);
    mlkem_zeroize();
    cptra_intr_rcv.abr_notif = 0;

    mlkem_encaps_check(ek, msg, abr_entropy, ciphertext, shared_key);
    mlkem_zeroize();
    cptra_intr_rcv.abr_notif = 0;
    
    mlkem_decaps_check(dk, ciphertext, abr_entropy, shared_key);
    mlkem_zeroize();
    cptra_intr_rcv.abr_notif = 0;
    
    SEND_STDOUT_CTRL(0xff); //End the test
    
}
