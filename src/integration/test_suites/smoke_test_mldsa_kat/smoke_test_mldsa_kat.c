// SPDX-License-Identifier: Apache-2.0
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//

#include "caliptra_defines.h"
#include "caliptra_isr.h"
#include "riscv_hw_if.h"
#include "riscv-csr.h"
#include "printf.h"
#include "mldsa.h"

volatile char*    stdout           = (char *)STDOUT;
volatile uint32_t intr_count = 0;
#ifdef CPT_VERBOSITY
    enum printf_verbosity verbosity_g = CPT_VERBOSITY;
#else
    enum printf_verbosity verbosity_g = LOW;
#endif

volatile caliptra_intr_received_s cptra_intr_rcv = {0};


void main() {
    printf("----------------------------------\n");
    printf(" Running MLDSA KAT Smoke Test !!\n");
    printf("----------------------------------\n");

    // uint32_t mldsa_msg[] = {};


    
    uint32_t mldsa_pubkey[] = {0x86EBA265,0xF989E450,0x0C8CB3E3,0x87CBE265,0x08A4032A,0xFB8E978D,0x80EDED75,0xAA4692D5,0xC010151C,0x22FC4A84,0x3F9EC4BD,0x804908A7,0x05A154CF,0x2A75A08D,0xF94175AC,0x8E1AF30A,0xEF9AFDCB,0xD3C4C6C2,0x65527FC5,0x57DBDF1E,0x390F1B31,0x12682AE1,0xBC1AE0A4,0x5334FEAF,0xED6D1A7F,0xC508068C,0xE2374188,0xE40B4C03,0xFE8C3735,0x51C5C1A8,0xBD4C707A,0xD00B6DF7,0x7808B06E,0xE9F0464E,0x75508C1D,0xFDA68A54,0x3D6616B3,0x7F37FE2D,0x1E43F947,0x11F43A7C,0xA806728B,0x2C1B9DC5,0xC3BF3FE8,0x6740CDE4,0xBE46A95E,0x99818CD2,0x77B12E75,0x878FA1DA,0x028A3004,0x0F643DDD,0x97F5F776,0x1056578F,0xBA1C6AB2,0x56A803B5,0xB73F4D1C,0x35EDAF40,0x370D4A82,0xCA5AC8E7,0xCA15C1CF,0x77543D49,0x292E4DDE,0xB4CC6721,0x0839039C,0x85FD09D9,0xAA3B1670,0x7E91B025,0x96240B26,0xC9E835ED,0xA8337DE7,0xAAABE7D1,0x7F6CDCC2,0x9A5E1F89,0x6110265B,0x7A458868,0x3FE14037,0x1906917D,0x32B2E788,0x5DE8EAAD,0x0035F476,0x6D0D5433,0xC86D8B90,0x9DAF5AFB,0x02754AE3,0xEC78C804,0xB939D04F,0xE775A777,0xCC8BCC0A,0xB91CE397,0x24A2CB04,0x49B3F251,0x9EE08673,0x5694E2F2,0x66A3936F,0xADF367A0,0x32C84808,0xDD355F80,0x5DDCE286,0xBAF7DD3B,0xDC27DAB1,0x71422401,0x6E1131C2,0x22187472,0xE3F9B346,0x37DFE6E5,0xE5B2C959,0x7A8C0AEB,0x21532EEA,0x8F9B1730,0xA20FF975,0xC7EE0FCE,0x46513DF1,0xC87C7A9A,0xDF3B1525,0x267F5FB9,0x230A5E2D,0xA4CAC075,0x5C261AF5,0x9BE7F837,0x550A1EF1,0x3F3927A1,0xC19909D9,0xA308438E,0xEDCA0E01,0xEBA5AC55,0xB53A9E7D,0xF7259A99,0xD0F1DC54,0x31CB9AB3,0xEC47E0E7,0x0AD2EF0C,0xFBA99764,0x7327A579,0xE6A4DFC8,0x4DD4D496,0x69F8431A,0x401038A4,0xC60FC5E6,0x681F46F4,0xCC13FF02,0x64ADB54D,0x1651050C,0xCC13505E,0x48314889,0xF34F023B,0x31F5AC55,0xCF6DF0D6,0x546486FE,0xEB645421,0x71DD2CE1,0xB80A7BB0,0xD21A1BD1,0x2B2E0410,0x6DC1D062,0xD3A82BD9,0x2539E9AA,0xB000B53C,0xA1A9D22C,0x8D3B2870,0x2CD9E0A0,0xE4A6E104,0x9EB64B08,0xF47C409C,0xAAEA917C,0xFD656FDB,0x1975E91B,0x8D33168A,0x3A3FE4F1,0x6D948677,0x37612956,0x5C07FC96,0x1301A45B,0x2120A6E0,0x5D0CF00F,0xCD5EB40A,0xFE2C45B4,0xDFAA84CB,0x428B1AC2,0x379CE170,0xA31C75F6,0xC0E94CEE,0x84AF08CF,0x22EA3FD7,0x3CC31DB3,0x88F77D20,0x764AC80E,0x9D98F951,0xE4344328,0x1F3922DB,0xBD7667B4,0x36CEEE30,0x311A9DD1,0x23A7596C,0x46EE991C,0x5367EACC,0xBE4C0E03,0x44147C06,0x5754F5B3,0x63020C90,0x93BBDA21,0xCEDD00B4,0x47E97C8F,0xFE0616F9,0x76E5D9E2,0x64563379,0x9E25419C,0xAD1D5DBA,0xEE26B160,0xD3A7777C,0x3CAAFD89,0x93AE177C,0x90D31FF8,0xFAD80E92,0xA6C01486,0x23B3EB04,0xF1CD67B1,0x5C0BD4C1,0xA1838FAD,0x512B9632,0xD5A13503,0x879D1E44,0x093745B1,0x574D236B,0xEBC77D1A,0xE82E02EA,0x2924F83C,0x942E7A11,0xD83D7744,0x8B9939B0,0x588D84F7,0xE64727C7,0x3647AEC3,0x2776C2F8,0x67F49675,0xF9807A68,0xE4FA09B2,0x268859F5,0xB27AD89F,0x7EA7F1C8,0xFA1E62C3,0x161D5A92,0xC167D4B5,0xA2E76CFF,0xB8D74135,0xEA212C51,0xA4CCE21C,0x909FA2F4,0xB2CA63C6,0xE193513D,0x8C83D716,0x307FD122,0xE4A6482A,0xBB12C25F,0x57703D37,0xD170C5DC,0xA08D9D39,0x498048D2,0xBEE47DF2,0x6F64ACC6,0x869D7705,0xECE71947,0x0C69B270,0xBB2DCF12,0xCC014DF3,0x99BB6818,0xA1E8BCDD,0x9769AAD4,0x20261F94,0x6B7B0E73,0xCE859516,0xB9342F0E,0xC2580882,0x9E569895,0x123AD2E9,0x8C8DAB00,0x5D8096B8,0x49497892,0xA749A543,0x601F846D,0x87CD89BD,0xF6710D5D,0x564262DD,0xBC5EFC06,0x9F33D9BD,0xD8A0B04B,0xCE9ED672,0x038F1031,0x937A9769,0x3B9A9933,0xBD577935,0xB00B3DD9,0x249B3694,0x78F5561B,0xAC686335,0x77BF71C2,0x7895D054,0x3B0BC67A,0x068E0500,0xF90DAF1F,0x5F18011D,0x04A506D3,0xB9AFDE41,0xF5988991,0xA30A109D,0xA4B2D4AA,0xC5757A74,0x29410A27,0xCF63C1B5,0x810074CF,0xD5AFF6A4,0xC4036DB6,0xD4CD62CB,0x75895291,0xA3070D39,0x9C8F435C,0xE0A2C266,0xFB528501,0x1172C444,0x204F837C,0x6992E2FF,0x444EE28B,0x22A2FB6B,0x8193FE71,0xD0384314,0x6099CAAA,0x242CAC6F,0x74ABD5FD,0x87576A69,0xEBAF3543,0xC6774017,0xB7A1FF58,0x51660B62,0xF54876EE,0x54AF01FC,0x9024BBEA,0xE59A9283,0xC1BBC3E9,0x2CDE19E7,0x3F34FA57,0x5803AAAB,0x0DEE72B2,0x088FB8E0,0x920AED48,0xDE6D5C12,0xF8E9CC64,0xE9E96F15,0x3243B997,0xEACE8792,0x11885891,0x67F43C66,0x0DDBA9DC,0x067FD857,0xAFFE6145,0xC49EBB6F,0xDBE9D4F6,0xFCBE420B,0xB5D4D315,0xF5E2CA1D,0x519FA65D,0x71203ABA,0xBCD82A41,0x67B9C8FE,0xD8A45141,0xA2DAE155,0x71A61E80,0x169B234C,0xFA1E29F3,0x52D0678A,0x487B84BA,0xC6DBA09E,0xB8D66FBB,0x7B3C1311,0xC715192E,0xAB0E5F51,0xEE5C9E8F,0xB30D1027,0x99C4E677,0x942B9572,0x83EF9A6B,0x5009C784,0x975CF386,0x318D7637,0xAE863375,0x2E8E54DC,0xA2B83CA7,0xE49CBC2F,0xFD48AFDB,0xC3D1098A,0xDEFFD170,0xE981DD89,0xBC5996BF,0x60DD58CF,0xEE25C98B,0x49C1CDAD,0xA7015406,0xF001D816,0x0F496131,0xA7C7CEE2,0x45E969E4,0x4EBB9136,0x1F67F19A,0x2F40A941,0x4C401635,0xA927A664,0xB770F7BA,0xEAAD8BC9,0x2F77C897,0xCA3266CB,0x1334F8F6,0xBF07E327,0xEF3BCDDF,0x28552A3A,0xF763CD52,0x6C7AAE3A,0xE1AA0212,0x12FDD48A,0x3FEDDD60,0x44CAC283,0x4C0B0201,0x5385C92C,0xECF10DBE,0xB46F85EC,0xC09BAB13,0x533E7AE1,0x148CF63F,0xE8CF943C,0x563DCFB6,0x6A986B66,0xC3A4D29D,0x6CD59F88,0x37B2FAF1,0x0AB55AE3,0x7C0BA03C,0x82319C65,0x17F1F21B,0x2C1C9D28,0xD328B8F8,0xD1B2DBDD,0x2F4E1D61,0x06C1B96D,0xF68818A0,0xC16200C5,0xA5112046,0x197E8CCE,0xF6987B49,0xA9BD0D17,0x3CDFFF9B,0x881134C5,0x72C78104,0x4F183E25,0x1EB3ACF7,0x7C98E2E0,0x9E5ABE94,0xD560C6F2,0x40295F55,0x2192770D,0x1E0CF08E,0xF6573882,0xC64DB14D,0x4B7EC869,0xF3505E76,0x4CA181B9,0x898EE04C,0xD824C93B,0x36290B1A,0xE286C216,0x5B02D7A1,0xC02CF6E3,0xD4530317,0xCC53164A,0x34E675ED,0x6FCAED96,0x8A67A975,0xBDAF4717,0xA8F93449,0x4235FF4B,0xC29DD78E,0x8610B3CB,0xACF8776E,0xB687D264,0x82E7E54C,0x4EEC6388,0xF27BE203,0xB582549A,0x8AD3DE91,0x396A613A,0x061297CB,0xEB572AB5,0x59E95F0C,0xA078D9F0,0xFE2C6898,0x3069C372,0x2B771A79,0x18CF81AD,0xC6A4EB59,0x220CF0FD,0x2874EAEC,0x19901940,0x233ECE85,0x8767E85A,0xB96C8CC5,0xE2F671E1,0xAD10BA56,0x121683E9,0x2EEC5B39,0x4DA24E46,0xDE8A0C89,0x85DAC50A,0xBFF99161,0x8E819A59,0x2CD3C6DB,0xC29C433C,0xC7A248D6,0x39CD3A17,0x2F2BD674,0xE9D18818,0xC78AD6E5,0x0CF09C56,0xE7FEACEE,0x93966BCB,0x27AEA7D0,0xE6D09945,0x2958EC60,0xC5F0D1D2,0x27CA5B34,0x2004AF21,0xB1B8C43A,0x27CF1154,0x2A478BF3,0xB5C87DE9,0x0E801E4C,0x81C4EE13,0x1477B663,0x196E03DA,0x4A307C8E,0x1D1716A3,0x6E1721A5,0x12748F01,0xA595464C,0x30FB90B1,0xEE1F5394,0xE8E31388,0xBA5C7CC2,0x73A61A12,0xACCAA671,0xDBFED51F,0xC9E50EA5,0x36116C48,0xE56FB8F8,0xC2C28859,0xD937A224,0x8D4C1BEE,0x872FF12A,0x75A3E93A,0x4A938408,0x02B920AD,0xF6AD2DBF,0x1CDE092E,0x2C8373FA,0x22E6DE1E,0x062E8D5C,0x71413DA5,0xDD48957B,0xDEE89722,0xDABC0B01,0x464E22E3,0xA5CDF0BF,0xEAEA5879,0xED77CA5B,0x34FB1925,0xBB925A44,0xC2D54BF9,0xA00519DB,0xC68E4591,0xE08A7AF2,0x547931D5,0x403C42BD,0x7A25C4A7,0xC286D8D1,0xA6D06608,0x668E6890,0xB222A8DF,0x12DC7E06,0xB891BF5B,0x0AA145F1,0xADAEB915,0x3A58F9FC,0xF63154E1,0x8E08B6CC,0x5FE09D7C,0xCD659A12,0x939A3F09,0x86BE7AD5,0x344D5306,0x243F2E5E,0x970A797A,0x5B268A85,0xFE721D5B,0x9D447ADF,0x725080E7,0x49B88F79,0x5BB2476D,0x232BAE3B,0x4539B5B9,0x286DB664,0xC547DD9A,0x037F2DAF,0x6034122F,0x7F10AA8C,0x72CA123F,0x91909C4A,0x1025B4F6,0xDD88319D,0x5BDACB85,0xD3E1A945,0x2668AFB8,0xCA012B3B,0xCC3DB180,0x982951A2,0x87F8F376,0xD59C573C,0xD0262D59,0x8925E162,0x365A79F0,0x5030D5C3,0xC7854F19,0x964CEF5B,0x08BC0F1B,0x542A8F87,0xDCD29F6A,0x07289F6F,0x7138C31A,0x6D70EAEB,0x89BE30A6,0x3DFAAD20,0xED7366E0,0xF71DBEA8,0xB308E416,0x321307D1,0xB63FA54E,0xDBB8691C,0x2AD4B624,0xD0781D5A,0x6CF2118C,0xB3C56A6D,0x4C0F5544,0x303DAA72,0x3AE181A7,0x87BD643E};


    uint32_t mldsa_seed[] = {0xDFCC13CE,0xD6971EB1,0xBF3243CB,0x8EE883FE,0xA9677D1E,0x5DA8F304,0x6CFA4305,0xDFB79127};


    // uint32_t mldsa_sign_rnd[] = {0x00000000,
    //                                 0x00000000,
    //                                 0x00000000,
    //                                 0x00000000,
    //                                 0x00000000,
    //                                 0x00000000,
    //                                 0x00000000,
    //                                 0x00000000}; //deterministic signature


    // uint32_t mldsa_sign[] = {}; //last byte 00
    
    
    uint32_t mldsa_entropy[] =       {0x3401CEFA,
                                    0xE20A7376,
                                    0x49073AC1,
                                    0xA351E329,
                                    0x26DB9ED0,
                                    0xDB6B1CFF,
                                    0xAB0493DA,
                                    0xAFB93DDD,
                                    0xD83EDEA2,
                                    0x8A803D0D,
                                    0x003B2633,
                                    0xB9D0F1BF,
                                    0x3401CEFA,
                                    0xE20A7376,
                                    0x49073AC1,
                                    0xA351E329};

    uint32_t mldsa_privkey[] = {0x86EBA265,0xF989E450,0x0C8CB3E3,0x87CBE265,0x08A4032A,0xFB8E978D,0x80EDED75,0xAA4692D5,0x6BEFF71C,0x2EB55361,0x83747EED,0x21768A95,0xB3CD546B,0xAECDFD72,0x0956DF06,0x7C4F25B1,0xB01B94DA,0x624F662E,0xCA6B0B7F,0xB63829A8,0x5DC80197,0x6DCE9375,0xACBB1661,0x0E1F4C84,0x10072775,0xFCBEC4F0,0xB34F7E9A,0x81ADFFD2,0xB8BC2B65,0x1CAE1D07,0x9D43DF24,0x6462AD64,0x9BA26DD1,0x0051C824,0x2CC0B64C,0x1C4064A3,0x26654198,0x64131788,0x9C302AD1,0x16442418,0x72238348,0xC2B84C14,0x080C8920,0x65C42041,0x48044C10,0xC88D0930,0x901A2549,0x8C208154,0xB60C1B26,0x290BC590,0x98028A49,0x3684DB06,0x0C4CA668,0xC4C828CB,0x08850C44,0x51D2C62C,0x0CA620E2,0x804C6228,0x6CC2480C,0x93880840,0x36816296,0x4091020D,0x23C348DC,0x00525C46,0x6604B48C,0x00C844C2,0x32449C36,0x65910028,0x42960D20,0x214C0808,0x0143A671,0x0A9468C9,0x3892E008,0x65609871,0xA4C29050,0x46720BB4,0x48E4B470,0x232682DA,0x46652122,0x91194150,0x13490D19,0x434A04B8,0x050C020C,0xC8108698,0x060C4CC2,0x0C58422D,0x533830A2,0xC888E038,0x711AB941,0xDB242600,0x892C0005,0x24C11411,0xA3A87021,0x22241442,0x90C9A830,0x10046ED3,0xC00C2237,0x901C3169,0xC9802481,0xA0400A32,0x700B2580,0x1A254803,0x40689128,0x20D91291,0x02902CE2,0x186ED240,0x89084988,0x99C4404A,0x94202119,0x08238845,0x9A4020C1,0x10649044,0x609BA061,0x92406560,0xB2215032,0x4A91B48C,0x02B21000,0x0448E046,0x5210C344,0x909401E2,0x12400191,0x60C92084,0x09C66503,0x82888288,0x2C214751,0x60068C99,0xC200E024,0x6C93B051,0xA4229094,0x082E9216,0x6D81A008,0x10026411,0xA6491231,0x5062364D,0x60460219,0x41511889,0x44C4282A,0x40040280,0x1411D4B8,0x49C03049,0x5A00501C,0x80044428,0x12828460,0x614045D8,0xC4241338,0x06991686,0xA0A42D03,0x31855006,0x89C0A085,0x20492419,0x48001839,0x85D9C225,0x12A71019,0x1704D820,0x06D9408A,0xC1928910,0x170619B1,0x0150088E,0x9AC84980,0x36524B24,0x4D8A8221,0x11214022,0x82698102,0x51C92882,0x992268C8,0x80418394,0x2D081889,0x4C068A04,0x0662DB38,0x32DC3469,0x11C961E0,0x120E4016,0x4522A08D,0x82926004,0x2141A090,0x51182500,0xC1421053,0xA664E118,0x4C19A340,0x00222D48,0x22915AA0,0x284B2640,0x12C111E0,0x346D1B95,0x70103790,0x23C9850C,0x380DE428,0x30114226,0x14A6484A,0x3452E142,0x12820609,0x0C07820C,0xB1651345,0x6224878C,0x0993005B,0x966CCB34,0x48188000,0x03124A80,0x02300302,0x61989025,0x4C329023,0x85001A35,0x50083885,0x930472C4,0x288E10C9,0x00634204,0x604409C8,0x0226D244,0x2D600462,0x43988422,0x264422C4,0x9022B260,0x0CA84D4B,0x14510441,0x7061B610,0x99A468A1,0x440DE136,0x8A994486,0x401691D2,0x0281CA24,0x44201148,0x99268190,0x10281242,0x8D501651,0x19404060,0xB80C0243,0x4E0B3672,0xA04461E0,0x40491247,0x4211C024,0x04059243,0x94649932,0x82C1106D,0x01144A00,0x21851425,0x25224626,0xA0B888E3,0xC80DA028,0x08DC8481,0x00912C0B,0xB0290295,0x21193730,0x41B68CC9,0x28041119,0x5252146E,0x64204213,0x202DDBB4,0x09583405,0x52C82003,0xC80C5028,0x281C928D,0x0AA20510,0xB345D438,0x88928404,0x1A8649CA,0x16899018,0x08144712,0xA2243104,0xA6118214,0x68CC8220,0x9A04525C,0x38501CC3,0x6DE1C46D,0x11B16112,0x32094438,0x90E11250,0x1C37705A,0x4001D944,0x4809C071,0xD98088CC,0x141203C9,0x25534049,0x12C90084,0x188E83A0,0x219A9028,0x13394CCB,0xB0001A29,0x6E889471,0x8A166222,0x3221E1B2,0x85241741,0x2193711A,0x86448118,0x711CB40C,0xA1A0310B,0x03851415,0x4EE41684,0x61100009,0xB25012B9,0x4113C229,0x02448422,0x17411B44,0x0AD29230,0x61002A20,0xB390CA42,0x04001582,0xDB284D52,0x32246038,0x91132801,0xD3326C9B,0x182DCCB4,0x50E4C024,0x83121120,0x8384CA14,0x4D0C0741,0xC8962D9B,0xC631C012,0x10CA2041,0x0C442A1C,0x1126C928,0x46E3B66C,0x2021828B,0xA2912101,0x6440142E,0x1BA24C01,0x48001BC3,0x8C032726,0x1144260A,0x010A0330,0x46DBC849,0xE382810B,0x0370DC20,0x8C0A9740,0xD00028E0,0xC06D61B2,0x84431801,0x13B3690B,0x394E0016,0x60249425,0xA228251A,0x81314B26,0x850C3282,0x5A8260D0,0x160D0982,0x800B8708,0x21B94CA3,0x24600943,0x48C23662,0x48244C88,0x82115204,0x4E231404,0x0A353048,0xC6840B97,0x69803810,0x48088EC4,0x94646232,0x808C3451,0x4A1220D2,0x080C8338,0x4252262E,0x13C211DA,0x08648CC4,0x890C4746,0xD8C62512,0xC56D64C8,0x70CB4600,0x11B42053,0x98609294,0x488BC809,0xDA28848C,0xA2681989,0x044C4431,0x12B085E3,0x2680C234,0x509C484A,0x23258622,0x472953B8,0x8444A468,0xE1181103,0x2820D008,0x0D8AC484,0x138829E3,0x8410A498,0x490C1642,0x91C80522,0x85411A05,0x6118158E,0xD4A430D0,0x40112248,0x62A48684,0x60144EA0,0x004012B2,0x31A09480,0x2325125C,0x164CCA88,0x70043168,0xC4A6851A,0xB644D928,0x08A41462,0x13346A03,0x81089234,0x28224112,0x8192C623,0x8102623B,0x7DF4F576,0xA60F0705,0x211FF78F,0x5BA73A02,0x0C3B5D12,0x6AE4D98F,0xB954C361,0xC73C0DFD,0xB8B56A66,0x66BEB0E1,0x1EDD0336,0xDCA6E9A6,0x15259DCA,0xD0FD54B0,0x0385AF5E,0x6CF0835D,0x2C8A20AC,0x908793D6,0x5180777E,0x45CD2C33,0x97BF92CE,0x8B121C94,0xB3B4E410,0x816938B4,0x34553F46,0x4F6A3F8E,0xFCF18895,0x53160A4E,0x00BC90D7,0xE0B45571,0x7633936C,0x3EF7031E,0xEC468053,0xF036EF3F,0x1B3156FB,0xAED8E93B,0x62132BC5,0xC52D0478,0xA12ACD5E,0xD7FCD44B,0x088588F2,0x1A416B76,0xB3A1E05B,0x4BD04A2E,0xE2F210D8,0x12C67C46,0x38587EB6,0x14E7956C,0x3FEC3A12,0x8F41B034,0x27624C98,0xE2652CB3,0x7F6F6485,0xB776C958,0x7ECD1E24,0x520DE64B,0x2A9E925B,0x950F89ED,0x3FB37291,0xF520B96D,0x9AC760AB,0x59B9933E,0x48AA8521,0x06883D06,0x83DCE40C,0xBAA4EE8F,0x04ED06C2,0x0E6F1EB8,0xA71D8439,0x13BD8BA2,0x53524731,0xACB3761E,0x94DC2C99,0xAC1022F7,0x713C45D8,0x5A46E704,0x2B4699D2,0xCCD9E6C3,0x930EF996,0x0BECC2C8,0x8259C89C,0xBC9FBCA7,0x279575D6,0x5341DE40,0xCFB2DC3C,0xD80590D4,0x6C5641E5,0x9DF726E6,0x8FEA6D14,0x5D0E385B,0x4E03D98F,0xED14E85A,0x3ADC9A71,0xA4C0F385,0x2E160B19,0x48D4FE1A,0x2F77F417,0xC7DAA829,0x077B94BD,0x8B9FE469,0x5B063279,0xE0844556,0x6A2E6C88,0x716058A1,0x2D0DA5D0,0xE619300C,0x692B9F16,0x22DB0838,0x5E745FDA,0x142B21D7,0x3BA3FC12,0xCD8D8E64,0x4B062DDC,0xA0158659,0x7F2EAE88,0xFB44F00C,0x594987D1,0x2AD94A6F,0xC54736C5,0xFC582796,0xF8F7E036,0x21EE0A2C,0x686F804B,0xBA9C55A1,0xAB856761,0x683289AA,0xAE5220FC,0xE946F7C3,0x3F75898F,0x01813DD1,0xB96290B2,0xA0D6E841,0xA375A7CD,0x81611514,0x7D729883,0x731A9B84,0xB55EE22F,0x6D7CA10D,0xA8CEB75C,0x6D14C09C,0x16C6C08E,0x530FB5C0,0x2AE2872B,0xD176FF90,0xE7F72398,0x36A74099,0x737AC774,0xC724ED44,0x5016827B,0x6A7EF68C,0xC805B0A6,0xF42EBA2F,0xF2D2B6A4,0xFA44678D,0x9D2187C3,0x94A479CA,0x5B36011F,0x434A2FD1,0xA59B06ED,0xA840F558,0x943D90E7,0x27268448,0xEAB60153,0x8E1D57BF,0x18AE50A3,0xA63D5105,0xC4814FEA,0x4F65C5A2,0xBD5007B5,0xA45995A7,0x62757B0B,0x7EE04372,0x6881DBCA,0x26CA0657,0x8B2E3DC0,0x6DE18815,0x3FEB80F0,0xE798C34C,0xF2E6230D,0xB50072DB,0xBE055EF4,0xCB8F8E89,0xF83FCC11,0x9138C531,0xBB24F490,0xC90DA49C,0xF5CEBA38,0x3E507350,0x2DA63E0E,0xB6C07E61,0x1645EDD9,0xBE7A8101,0xC439A877,0xAE846544,0x5F17E0E6,0x65DC2E03,0xA0459B67,0x594DE4A2,0xB4FB4846,0x16FD9DB0,0xA5B593A5,0x0C4BDE32,0x36E10D35,0x3D394C36,0x811688BF,0x41FA2822,0x6045B8CC,0xC6E4D0F6,0x81B749FE,0x0340D0AB,0x52CF7843,0x83BE321A,0x258048DE,0x6971549B,0x6549620E,0x6A7B71D9,0x69E638AB,0xF3A5E40C,0xD19CCA73,0x32B941D5,0x4661BF26,0x8C7799C3,0x7B32C639,0xCD3C5B1C,0xD2FE73B0,0x42823379,0x45FEC513,0x1FB8990B,0x52EFEA62,0xDC02E340,0x8174B759,0xE1DECF8A,0x19398875,0xE4DBC73B,0xAD436978,0x3FFED5B7,0xCE954ADB,0x3AED6D3D,0xAA997463,0x86EA5141,0x1EDE7D72,0x8CFF25BB,0x33983950,0xDD212D59,0x2C5C3E3F,0xAE90E011,0x5DB93511,0x85065723,0xCFA42EFE,0x64242D10,0x5FAC5040,0x3DC35018,0xE2E7BFAB,0xC7F868E4,0xC7D34424,0xBF42B14E,0x42EE84CA,0x911F5F3D,0x466EC727,0xD472BDC1,0xD84BE1C7,0xA4460A36,0x966CCD8F,0xEEC52AB5,0x51566AAD,0x0F2C1B24,0xAE259CD6,0x55B0AFBB,0x2CC4BE38,0x704499F9,0xFEFFDE6A,0xACFDC54F,0x5FCD5123,0x361C9C01,0xC7BA5B52,0xC128D6C3,0xD596736C,0xCC82E09C,0xF7EB8FA0,0x6510E038,0xADB0F6C0,0x0234C301,0x4C5D10DB,0x6519EEC9,0x5DD9D192,0x00930D9E,0x5EC24F06,0xD206399E,0x492C10CA,0x910A4A0C,0xFAB970BD,0x1BE66E2C,0x1D9B705A,0x1B7E3C01,0xC443E54E,0x0F10D9F8,0x90EF21C5,0x43138EA6,0x49759EAC,0x899A32A3,0xFAE1BCCA,0x5F7522EB,0x4D524C13,0xAB36AE5E,0xF2FAFE33,0x545674CA,0x0F70573F,0xB0D674B1,0x4CA0CB87,0x3C338385,0x58B70006,0x92B288D7,0x0C09E3AD,0x9E514D95,0xB970911E,0x2CC3C9A8,0x5179C2A3,0x9B858664,0x0CF6F34D,0x203DE9C1,0x0829DBE1,0xBCCB34CF,0x9C83D734,0x4A73305D,0xD9292CBF,0x0160CA13,0x9FE5419C,0xC012E69B,0x741DCF35,0xA3DE0882,0x2D27B968,0x0C7E63F4,0xFA0B824A,0x7259E932,0xBA573E17,0x2C81B46D,0xC710B1F8,0x161EC2D2,0xB880D174,0x8B5F08FF,0x52FA8D6C,0x94539A15,0xEE5024E1,0x4712AE62,0xB196675C,0x7FB17C78,0x02FB68F4,0xC3C7888F,0x9CE863EB,0x82C3B9A8,0x40A9E1FE,0x8BA0A440,0x644A9262,0xE7F92458,0x0F059EC0,0xDD2CF948,0xF4D77DC7,0x6FA360F6,0xCBD022CE,0x3502765A,0xF333D79A,0x4C2257AE,0xCB069116,0xCE1DB696,0x3A11401E,0x93EEB8C5,0x4B03FECB,0xFCC8C68B,0x8E1C049B,0x6D348FCB,0xF52BA7FF,0xB264C5EA,0xD3D15D95,0xEEE901DA,0x2FB401FA,0x0BFA8691,0xB004A411,0xD2925E47,0x9A05973B,0x090AC060,0xFCAC093A,0xE9C42DB1,0x04420AAB,0x012B55D5,0xC67D26DB,0xC5B8ABC6,0x5A189D4E,0x7BB40DA1,0x2C121FC1,0x66BB1D73,0xBC6625E8,0x7D42F8D6,0x33EF76F4,0x3E1F0BE4,0xC6211C19,0x22CED066,0x85E89535,0x3FE67CD7,0x0219AC3B,0xACD6EAD3,0xC54B9298,0x5E5A12A8,0x05EB8FCD,0xF31BDC1F,0xED3C730D,0x3D9D62C2,0x2E8F24A9,0xD73D5895,0xD92DB38D,0x783F8EB7,0x36D80911,0x7B45C35E,0xE8F40056,0xD6906371,0x73785D1E,0x14E0EA90,0xFFA8C978,0x64B63232,0xD2AAED14,0xC2415A00,0xF84D954A,0xF103014F,0x676ADD18,0x17AB83B8,0x51CC0163,0x11BF3133,0x3915ABBB,0xD7EFD264,0xCCF472FD,0x99E86D53,0x5E149788,0x5774D17F,0x07D19E0C,0xFDB00F7A,0x6682E511,0x052BE0BC,0x1846D8DA,0xB4789770,0x34D0CBC1,0xDFC72FD7,0xF68AB51C,0x824FC881,0x15DAAE9E,0x203D5033,0x294156FB,0xFB6E0F40,0x0B7B8F08,0x61DAF592,0xD4936C48,0x3D5DBDC9,0x8B7A576C,0xC9D26E54,0xEAC4CF24,0xFF91797D,0x48AA1374,0x772D7F0B,0x9EC4AF5A,0x76E231E2,0xE847B7D9,0x1F8A6D89,0xA78EB1F7,0xA039C3F3,0xE5C3714F,0x2C622123,0x82806D78,0x424223B8,0x4615ED36,0x1C49AFDC,0xBB922435,0x55B0D777,0xDFB8F000,0x05232FA8,0xC97916ED,0xAD87AEB4,0x66EBCDA6,0x150F0ACA,0x969B2D21,0xC2E5FE2D,0x7C4177E6,0x22FEBCE6,0xAACE0842,0x386D29A1,0x7FAB242B,0x3F926BD8,0x700340CA,0x7B4B5383,0x200DE7C9,0x3A701CA2,0x2B9412AC,0x2F1C2139,0xB9D332FD,0x585B8E6B,0x1E072109,0x0F64BF87,0x1A2D0C0B,0x5E0A0391,0xE2A0D1A9,0xE9103BD0,0x8DE12749,0xA6F6FF03,0xD2597B1F,0x3BF33819,0xF9AB2EF8,0x3B092744,0x5BD727F1,0x61279C6C,0x2DD2B68C,0x229BF233,0xF8BCCDB4,0xA61D866F,0x2D4F7054,0x39F990A3,0x2A0BCE93,0x360E7981,0x29D95F28,0x4B942ABD,0x702081AB,0x6D1813FB,0xD52B58A4,0x21E96FC0,0xA715EF13,0x4CB1297E,0x2AB3C91E,0x581E3CF9,0x72234814,0x75D955DA,0xBF2D0B8B,0xB5F134EC,0x14D84F10,0x2C9C57CA,0x4B90589C,0x1C525054,0x4C760EC6,0xCE839AA8,0x5BC0681D,0x744F716A,0x0E08DA4C,0x2201D3C7,0xEC51492A,0x0516C9CC,0xA8F912B0,0x3CF60AEB,0x07F4ADFC,0xA22C43F2,0x34897A8F,0x518271DA,0x5AE07A8B,0xC6CDA35A,0x5A58FC99,0x1CCA18E5,0x9E4CDD1F,0x15251823,0x961E38A4,0x9815FE8C,0x766B705D,0xB01A92C7,0xA13B7F68,0xCE43F21F,0x692EC29C,0xD085E70C,0xFF19C6CA,0xE0D08B30,0xA1558550,0x24BFC9D9,0x5C87A016,0x66EAA449,0x86ABCF2F,0x9E146CE2,0x6D2C12BC,0x816934D1,0x79D0FD0C,0xC1E11B5B,0xBCC03E56,0xEB056B61,0x96D4700C,0x77475267,0x4861A402,0xC1A94A00,0x32C5642C,0x68ABE913,0xBDE12AAC,0x92D335AC,0x19326389,0xCEC3C5BA,0xD1735C01,0x20B7EE10,0xA0E34AF4,0x50A66385,0x6D5931F9,0x195B5204,0xCF22A426,0xBD28A6E3,0x1234227F,0x033F311B,0xF0A826B7,0xB4F6E216,0xB63B3B18,0x4466AFFD,0xE10DA3FD,0x8EAAE99C,0xF91BA078,0x532A1ABD,0x8680B50A,0x5F4516E3,0xDEF7CC3A,0xD7BDAADF,0x662EE3EE,0xAF05F918,0xA598F979,0xA9512EB6,0x4BF3781D,0xF8CD9884,0x03FF0570,0xF21A6E09,0x484950F6,0xCEFA7AFA,0xE4142058,0xB39D715E,0x0E4F620E,0x026D187C,0x5A3D8C05,0xEA644F15,0x5AF31D6F,0xDEB43134,0x10AC7548,0xC88B8CD9,0x274D2B19,0x0F1B2ECC,0xCBBD7DAC,0x21C64703,0x8D2948DF,0x2DC80AEA,0x5E5923EB,0xE72D9C72,0x6E6DE0A2,0x66A8E6B9,0xAAC80E50,0xC7D9AEF2,0xE2E39192,0x41A82739,0xDDCD2CA4,0xAFCF501E,0x3500FD2E,0xC421D9AE,0xC0FB7A31,0x1ADAB51E,0x21393379,0x1EA6F055,0x7878056A,0xE3AE35FC,0x18428ADA,0x90B518F7,0x665F4E89,0x6EB78247,0xB580DB4F,0x2AA5FEF1,0x483155E0,0x8683B90D,0x8331EE81,0x18FB4EC7,0x38A19243,0xCFA72940,0xFF692E73,0x6D0B5AE1,0x11350775,0xF57A60CE,0x87CBF19C,0xC5677B1A,0x3BE9E780,0xD15E1D09,0x160C4720,0x713A4F74,0xA362C99C,0x85697586,0x382BC544,0x61B120D1,0x7977A09C,0xE326803E,0x055B1AA4,0xFDD4BEE7,0xCEC045BA,0x9138A30E,0x9B47DBED,0x84040E98,0x3CA09315,0x9E1F3B58,0xAD2E60E6,0x664C801D,0xD79A8C8E,0x766F6FE7,0x9D72547B,0xE2895C40,0xA469C47E,0x8AD31CF8,0xF5BB5E79,0x54383094,0x2289A5C0,0x99E89B2C,0x723D8A72,0xB2133C87,0xA25F6257,0xCA5E706E,0xF1E46EA5,0x9EB42EEB,0x9CD3D9AA,0x7A20D093,0x6F0EB8D4,0xF8E51663,0x434D8DAA,0x10B59346,0x38E49BF0,0xB8208B79,0x24BBF61A,0x1AE8282A,0xB13BFBC1,0xA8F2DBC0,0x03B48F8A,0x20EDEC06,0xCE9914CE,0x4EB1A5B9,0x16A36337,0xE71C30AE,0xD4969987,0xC3F56BF8,0x6F09E735,0x3E194602,0x161CC417,0x05301E7C,0xBC384EA3,0xA15FAE91,0xA17ED8E1,0xB98AAA66,0x69D32368,0x85CC239F,0x69DA39C2,0xA7B35860,0x5FC2111E,0x4B90C967,0x4DDF9434,0x832E0EE9,0x7171B78A,0x2226C609,0x9C0F5AE1,0xF6E2A74B,0x66F52EFA,0x4C2CF3D0,0xFF7B24DA,0xDA3A6279,0x0325C96B,0x990DFADF,0xD2AED3AB,0x5535413C,0x221D0C58,0x4A6D586B,0xFDF0E13A,0xCAB23EB2,0x108D996E,0xA4DD7E51,0x0C307040,0xAF311037,0x0D38CC72,0xB91B72CA,0xC1AE463F,0x6BF174EE,0x189CC125,0xC9FABB1C,0x59051DB1,0xAD6443D9,0x3A8F83FD,0x9E9C39A6,0x9C2D48A1,0x70BA0F23,0x36C48D65,0x3A06BE31,0x64636DDE,0x839BBFD2,0xAC9566F7,0x50B527CD,0x911A17EA,0xB10FAC46,0x0926DD0D,0x49871E07,0x0BB84413,0xA200C8EA,0xD2E1C2F8,0x642114EA,0x9688540C,0x57559DC1,0xD3D32598,0x8E1C34E0,0xD48F9E05,0xF731C910,0x4E83F396,0x09293AA7,0x60A8D877,0x856B68A0,0x8E99E6F5,0xD31A4C19,0xFB2C16B1,0x415D1F6E,0xD290C6C3,0x889196AC,0xB26018A6,0x8DE48316,0xEDAD2FFD,0xB783D874,0x75EF0B3D,0x23E91DC3,0xCEB668BF,0x71DC8616,0xB32B7A30,0x8DAF553A,0xC6C0B4BF,0xAD25AB48,0x166EA09D,0x4BC36BDA,0x8E34FF74,0x9A30278B,0xF0479FBC,0xCBC84DC6,0xFF077D77,0x76E4EB54,0xF3A67D7C,0xCAE3AA19,0xC149B336,0x58BB4075,0x14852296,0x09E21E21,0xBA6F0403,0xE4AA5377};
    //Call interrupt init
    init_interrupts();
    
    mldsa_io seed;
    uint32_t sign_rnd[8], entropy[16], privkey[1224], pubkey[648], msg[16], sign[1157], verifyres[16];


    seed.kv_intf = FALSE;
    for (int i = 0; i < 8; i++)
        seed.data[7-i] = ((mldsa_seed[i]<<24) & 0xff000000) |
                    ((mldsa_seed[i]<< 8) & 0x00ff0000) |
                    ((mldsa_seed[i]>> 8) & 0x0000ff00) |
                    ((mldsa_seed[i]>>24) & 0x000000ff); //mldsa_seed[i];

    // for (int i = 0; i < 8; i++)
    //     sign_rnd[7-i] = mldsa_sign_rnd[i]; //TODO: add byte swap - not doing now to save sim time

    for (int i = 0; i < 16; i++) {
        entropy[15-i] = ((mldsa_entropy[i]<<24) & 0xff000000) |
                        ((mldsa_entropy[i]<< 8) & 0x00ff0000) |
                        ((mldsa_entropy[i]>> 8) & 0x0000ff00) |
                        ((mldsa_entropy[i]>>24) & 0x000000ff);
    }
    
    // for (int i = 0; i < 16; i++) {
    //     msg[15-i] = ((mldsa_msg[i]<<24) & 0xff000000) |
    //                 ((mldsa_msg[i]<< 8) & 0x00ff0000) |
    //                 ((mldsa_msg[i]>> 8) & 0x0000ff00) |
    //                 ((mldsa_msg[i]>>24) & 0x000000ff);
    // }
    
    for (int i = 0; i < 1224; i++){
        privkey[1223-i] = ((mldsa_privkey[i]<<24) & 0xff000000) |
                          ((mldsa_privkey[i]<< 8) & 0x00ff0000) |
                          ((mldsa_privkey[i]>> 8) & 0x0000ff00) |
                          ((mldsa_privkey[i]>>24) & 0x000000ff);
    }

    for (int i = 0; i < 648; i++) {
        pubkey[647-i] = ((mldsa_pubkey[i]<<24) & 0xff000000) |
                        ((mldsa_pubkey[i]<< 8) & 0x00ff0000) |
                        ((mldsa_pubkey[i]>> 8) & 0x0000ff00) |
                        ((mldsa_pubkey[i]>>24) & 0x000000ff);
    }
    
    // for (int i = 0; i < 1157; i++) {
    //     sign[1156-i] = ((mldsa_sign[i]<<24) & 0xff000000) |
    //                    ((mldsa_sign[i]<< 8) & 0x00ff0000) |
    //                    ((mldsa_sign[i]>> 8) & 0x0000ff00) |
    //                    ((mldsa_sign[i]>>24) & 0x000000ff);
    // }

    // for (int i = 0; i < 16; i++) {
    //     verifyres[15-i] = ((mldsa_verifyres[i]<<24) & 0xff000000) |
    //                       ((mldsa_verifyres[i]<< 8) & 0x00ff0000) |
    //                       ((mldsa_verifyres[i]>> 8) & 0x0000ff00) |
    //                       ((mldsa_verifyres[i]>>24) & 0x000000ff);
    // }

    mldsa_keygen_flow(seed, sign_rnd, entropy, privkey, pubkey);
    mldsa_zeroize();
    cptra_intr_rcv.mldsa_notif = 0;

    // mldsa_signing_flow(privkey, msg, entropy, sign);
    // mldsa_zeroize();
    // cptra_intr_rcv.mldsa_notif = 0;

    // mldsa_verifying_flow(msg, pubkey, sign, verifyres);
    // mldsa_zeroize();
    // cptra_intr_rcv.mldsa_notif = 0;

    printf("%c",0xff); //End the test
    
}


